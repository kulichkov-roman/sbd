var RZB2=RZB2||{ajax:{params:{}}};void 0===RZB2.ajax&&(RZB2.ajax={params:{}}),$(window).on("b2ready",(function(){var backEndJsList=["back-end/handlers/commonsmin"];"Y"==b2.s.quickView&&("function"==typeof b2.init.catalogPage||"function"==typeof b2.init.homePage&&b2.s.blockHomeSpecials),"function"==typeof b2.init.productPage&&backEndJsList.push("back-end/handlers/catalog_element"),"function"==typeof b2.init.catalogPage&&backEndJsList.push("back-end/handlers/catalog_section"),"function"!=typeof b2.init.comparePage&&"function"!=typeof b2.init.comparePageMobile||(backEndJsList.push("back-end/ajax/catalog_compare"),backEndJsList.push("back-end/handlers/catalog_compare")),require(backEndJsList,(function(){$(window).trigger("b2handlers")}))})),RZB2.ajax.quickViewInit=function(target,fancySelector){fancySelector=fancySelector||".js-fancybox-2",target.find(fancySelector).length&&target.find(fancySelector).each((function(){"access_custom"===$(this).data("customPopup")?$(this).fancybox({beforeShow:function(){$("#popup-accessories .popup__main").html('<div class="load_quick_view"><i class="icon-load"></i></div>')},afterShow:function(){$(".fancybox-close-small").addClass("fixed-close-btn");var orig=$(this).get()[0].opts.$orig;ajaxPath=SITE_DIR+orig.data("ajax-url");var doAfterAjax=function(result){if($("body").addClass("popup-open"),result){if($("#popup-accessories .popup__main").find("#hydrogel-window").length?$("#popup-accessories .popup__main #hydrogel-window").html($(result).find("#hydrogel-window").html()).css({paddingBottom:"19px"}):$("#popup-accessories .popup__main").html(result).css({paddingBottom:"19px"}),$("#popup-accessories .popup__main").find(".js-card-img-slider-2").length){var mainSlider=$("#popup-accessories .popup__main").find(".js-card-img-big-2");mainSlider.off().on("afterChange",(function(event,slick,currentSlide){var baseItem=$(this).find('[data-slick-index="'+currentSlide+'"]').find("li"),name=baseItem.data("name"),pid=baseItem.data("pid");if($("#popup-accessories .rbs-buy").removeClass("rbs-in-cart"),$("#popup-accessories .rbs-buy").data("pid",pid),"hydroEls"in window)for(k in hydroEls)hydroEls[k].ID==pid&&$("#popup-accessories .rbs-white-button").attr("href",hydroEls[k].DETAIL_PAGE_URL);if("arAddedHydroInBasket"in window)for(k in arAddedHydroInBasket)arAddedHydroInBasket[k]==pid&&$("#popup-accessories .rbs-buy").addClass("rbs-in-cart");if("arHydroElsPrices"in window)for(k in arHydroElsPrices)k==pid&&$("#popup-accessories .current-price .value").text(arHydroElsPrices[k]);$("[data-name-tag]").text(name)})),mainSlider.not(".slick-initialized").slick({slidesToShow:1,slidesToScroll:1,arrows:!1,fade:!0,asNavFor:".js-card-img-nav-2",infinite:!1}),$("#popup-accessories .popup__main").find(".js-card-img-nav-2").not(".slick-initialized").slick({slidesToShow:5,slidesToScroll:1,vertical:!1,focusOnSelect:!0,asNavFor:".js-card-img-big-2",dots:!1,infinite:!1,responsive:[{breakpoint:520,settings:{slidesToShow:3}}]})}$("#popup-accessories .rbs-buy").off().on("click",(function(){if(!$(this).hasClass("rbs-in-cart")||!$(this).data("pid")){var _this=$(this);"/personal/cart/"!==window.location.pathname?$.ajax({url:SITE_DIR+"ajax/sib/main_spec_sib.php",data:{action:"ADD2BASKET",id:_this.data("pid"),ajax_basket:"Y",IBLOCK_ID:"6"},method:"GET",success:function(){!1 in window&&(arAddedHydroInBasket={}),arAddedHydroInBasket[_this.data("pid")]=_this.data("pid"),_this.addClass("rbs-in-cart"),window.isMobile&&$.fancybox.open($("#modal_add_to_cart"))}}):(RZB2.ajax.BigBasket.AddToBasket($(this).data("pid")),arAddedHydroInBasket[_this.data("pid")]=_this.data("pid"),_this.addClass("rbs-in-cart"))}})),$("#popup-accessories .popup__main").find(".hydrotype-item:not(.active)").off().on("touchstart click",(function(){$("#popup-accessories .popup__main").find(".hydrotype-item").removeClass("active"),$(this).addClass("active"),$.ajax({url:$(this).data("url"),type:"POST",data:{sessid:BX.bitrix_sessid(),webp:$("html").hasClass("webp")?"Y":"N"},dataType:"html",success:doAfterAjax,error:function(jqXHR,textStatus,errorThrown){RZB2.ajax.showMessage("AJAX error: "+textStatus,"error")}})}))}};$.ajax({url:ajaxPath,type:"POST",data:{sessid:BX.bitrix_sessid(),webp:$("html").hasClass("webp")?"Y":"N"},dataType:"html",success:doAfterAjax,error:function(jqXHR,textStatus,errorThrown){RZB2.ajax.showMessage("AJAX error: "+textStatus,"error")}})},beforeClose:function(){$("body").removeClass("popup-open"),$(".fancybox-close-small").removeClass("fixed-close-btn"),"/personal/cart/"!==window.location.pathname&&RZB2.ajax.BasketSmall.Refresh()},touch:!1}):$(this).fancybox({beforeShow:function(){$("#popup-accessories .popup__main").html('<div class="load_quick_view"><i class="icon-load"></i></div>')},afterShow:function(){var orig=$(this).get()[0].opts.$orig;if(void 0!==orig.data("url")){var data={},ajaxPath=SITE_DIR+"ajax/sib/catalog.php";for(var key in RZB2.ajax.params)data[key]=RZB2.ajax.params[key];data.rz_ajax="y",data.rz_quick_view="y",data.REQUEST_URI=orig.data("url"),parseInt(orig.data("service-id"))>0&&(data.QUICK_VIEW_SERVICE_ID=orig.data("service-id"),data.QUICK_VIEW_SERVICE_PRICE=orig.data("service-price"),ajaxPath=SITE_DIR+"ajax/sib/service_quick_view.php"),"access_custom"===orig.data("custom-popup")&&(ajaxPath=SITE_DIR+orig.data("ajax-url"),data={}),$.ajax({url:ajaxPath,type:"POST",data:data,dataType:"html",success:function(result){$("body").addClass("popup-open"),result&&($("#popup-accessories .popup__main").html(result),$("#popup-accessories .popup__main").find(".js-rating").length&&$("#popup-accessories .popup__main").find(".js-rating").barrating({showSelectedRating:!1,readonly:!0}),$("#popup-accessories .popup__main").find(".js-card-img-slider-2").length&&($("#popup-accessories .popup__main").find(".js-card-img-big-2").not(".slick-initialized").slick({slidesToShow:1,slidesToScroll:1,arrows:!1,fade:!0,asNavFor:".js-card-img-nav-2"}),$("#popup-accessories .popup__main").find(".js-card-img-nav-2").not(".slick-initialized").slick({slidesToShow:4,slidesToScroll:1,vertical:!0,focusOnSelect:!0,asNavFor:".js-card-img-big-2",dots:!1})),parseInt(data.QUICK_VIEW_SERVICE_ID)>0&&$('.rbs-buy[data-product-id="'+data.QUICK_VIEW_SERVICE_ID+'"]').on("click",(function(){$('.catalog-bottom__button.buy[data-product-id="'+data.QUICK_VIEW_SERVICE_ID+'"]').first().click()})))},error:function(jqXHR,textStatus,errorThrown){RZB2.ajax.showMessage("AJAX error: "+textStatus,"error")}})}},beforeClose:function(){$("body").removeClass("popup-open")}})}))},RZB2.ajax.subscribeForm=function(form){form.find(".sub-form__button").length&&form.find(".sub-form__button").fancybox({beforeShow:function(){var email=form.find("input[type=email]").val();if($("#popup-subscribe-form .popup__content").empty(),isEmail(email)){var data=form.serialize();$.ajax({url:SITE_DIR+"ajax/sib/subscribe.php",type:"POST",data:data,success:function(result){var response;"SUCCESS"===$.parseJSON(result).STATUS?$("#popup-subscribe-form .popup__content").html(BX.message("BITRONIC2_SUBSCRIBE_SUCCESS")):$("#popup-subscribe-form .popup__content").html(BX.message("BITRONIC2_SUBSCRIBE_FAIL"))}})}else $("#popup-subscribe-form .popup__content").html(BX.message("BITRONIC2_VALIDATION_NOT_EMAIL"))}})},RZB2.ajax.showMessage=function(text,type,title){var showInternal=function(){type||(type="success"),title=title||BX.message("BITRONIC2_ERROR_TITLE"),"success"==type&&(title="");var modal="#modal_msg_uni";$(modal).find(".popup__title").text(title),$(modal).find(".form").html(text),$('<a href="'+modal+'"></a>').fancybox().click()};domReady?showInternal():$(document).ready(showInternal)},RZB2.ajax.setLocation=function(curLoc){try{return void history.pushState(null,null,curLoc)}catch(e){}location.hash="#"+curLoc.substr(1)},RZB2.ajax.scrollPage=function($scrollToObj,forced){forced=!!forced,$scrollToObj.length&&(forced||window.pageYOffset>$scrollToObj.offset().top-60)&&$scrollToObj.velocity("scroll",{duration:800,offset:"fixed-top"===b2.s.topLinePosition?-1*$body.find(".top-line").outerHeight():0})},RZB2.ajax.loader=function(){return $('<div class="ajax_loader"></div>')};var smallSpinnerParams={radius:3,width:2};RZB2.ajax.spinner=function($obj){var spinner,Start,Stop;return{Start:function(params){},Stop:function(spinnerObj){}}},RZB2.ajax.loader.Start=function(obj,notLoader){void 0!==obj&&(obj.css("pointer-events","none").animate({opacity:1},500),notLoader||obj.addClass("placeholder"))},RZB2.ajax.loader.Stop=function(obj){void 0!==obj&&(obj.animate({opacity:1},300,(function(){$(this).css("pointer-events","")})),obj.removeClass("placeholder"))},RZB2.ajax.RefreshTogglers=function(list,togglerSelector,popupSelector){var elementCount=Object.keys(list).length;$(togglerSelector).toggleClass("rz-no-pointer",elementCount<=0),elementCount<=0&&"function"==typeof popClose&&popClose($(popupSelector))},RZB2.ajax.Viewed={isLoaded:!1,Load:function(){var viewedBlock=isMobile?$("#rbs-viewed-block-mobile"):$("#rbs-viewed-block"),_this=this;if(viewedBlock.length&&!this.isLoaded){var sendData={rz_ajax:"y"};isMobile&&(sendData.mobile="y"),$.ajax({url:SITE_DIR+"ajax/sib/viewed.php",type:"POST",data:sendData,dataType:"html",success:function(res){var result=$("<div>"+res+"</div>");isMobile?(result.find(".main-nav__text span").length&&viewedBlock.find(".main-nav__text span").text(result.find(".main-nav__text span").text()),result.find(".inner-nav.js-nav-hide").length&&(viewedBlock.append(result.find(".inner-nav.js-nav-hide")),viewedBlock.show()),viewedBlock.find(".js-click-close").on("click",(function(){$(".main-nav_inner, .main-nav_index").removeClass("open"),$(".js-catalog-button_mob").removeClass("active"),$("html").removeClass("menu-open")})),viewedBlock.find(".js-click-back").on("click",(function(){$(this).closest(".js-nav-hide").fadeOut(),$("nav.main-nav_index>ul.main-nav__list>li>a").removeClass("active"),$(this).hasClass("normalize-height")&&$(".main-nav_mobile .main-nav__list").css("height","auto")}))):(result.find("#rbs-viewed-block").length&&(viewedBlock.html(result.find("#rbs-viewed-block").html()),viewedBlock.show()),rbsHoversBtn()),_this.isLoaded=!0},error:function(){isMobile||rbsHoversBtn()}})}}},RZB2.ajax.Compare={ElementsList:{},Params:{actionVar:"action",productVar:"id"},Add:function(id){var data={};data[this.Params.actionVar]="ADD_TO_COMPARE_LIST",data[this.Params.productVar]=id,this.ElementsList[id]=id,this.SendRequest(data)},Delete:function(id){var data={};data[this.Params.actionVar]="DELETE_FROM_COMPARE_LIST",data[this.Params.productVar]=id,void 0!==this.ElementsList[id]&&delete this.ElementsList[id],this.SendRequest(data)},DeleteAll:function(){var data={};data[this.Params.actionVar]="DELETE_ALL_COMPARE_LIST",this.ElementsList={},this.SendRequest(data)},SendRequest:function(data){var _this=this;$.ajax({url:SITE_DIR+"ajax/sib/compare_sib.php",type:"POST",data:data,dataType:"html",success:function(res){_this.RefreshResult(res)}})},Refresh:function(){this.SendRequest()},RefreshButtons:function($node){"object"!=typeof $node&&($node=$(document));var compareButtons=$node.find("button.btn-action.compare, button.action.compare, .compare-detail, .compare-list-btn");if(compareButtons.length){var btnSelector="";for(var id in this.ElementsList)btnSelector.length&&(btnSelector+=","),btnSelector+='[data-compare-id="'+this.ElementsList[id]+'"]';if(btnSelector.length){var itemsInCompare=compareButtons.filter(btnSelector),itemsNotCompare=compareButtons.not(itemsInCompare);itemsInCompare.length&&this.ButtonsViewStatus(itemsInCompare,!0,!0),itemsNotCompare.length&&this.ButtonsViewStatus(itemsNotCompare,!1,!0)}else this.ButtonsViewStatus(compareButtons,!1,!0)}RZB2.ajax.RefreshTogglers(this.ElementsList,"#compare-toggler","#popup_compare")},ButtonsViewStatus:function(obButns,active,silent){silent=!!silent||!1,(active=!!active||!1)?obButns.addClass("toggled").attr("title",BX.message("BITRONIC2_COMPARE_DELETE")):obButns.removeClass("toggled").attr("title",BX.message("BITRONIC2_COMPARE_ADD"))},RefreshResult:function(res){var $res=$(res),count=$res.find(".rbs-compare-count").html();$("#rbs-compare-list .rbs-basket-hide").html($res.find(".rbs-basket-hide").html()),$("#rbs-compare-list .rbs-compare-count").html(count),$("#rbs-compare-list-mobile").length&&($("#rbs-compare-list-mobile .rbs-basket-hide-mobile").html($res.find(".rbs-basket-hide-mobile").html()),$(".rbs-compare-count-mobile").html(count),$("#rbs-compare-list-mobile .js-click-back").on("click",(function(){$(this).closest(".js-nav-hide").fadeOut(),$("nav.main-nav_index>ul.main-nav__list>li>a").removeClass("active"),$(this).hasClass("normalize-height")&&$(".main-nav_mobile .main-nav__list").css("height","auto")})),$(".main-nav_mobile #rbs-compare-list-mobile .js-click-close").on("click",(function(){$(".main-nav_inner, .main-nav_index").removeClass("open"),$(".js-catalog-button_mob").removeClass("active"),$("html").removeClass("menu-open")})),$(".js-del-btn-comp-fav[data-type='compare']").on("click",(function(){return RZB2.ajax.Compare.Delete($(this).data("product-id")),$(this).closest(".js-remove").fadeOut(0,(function(){$(this).remove()})),!1}))),this.RefreshButtons(),RZB2.utils.initLazy($("#rbs-compare-list .rbs-basket-hide, #rbs-compare-list-mobile"))}},RZB2.ajax.Favorite={ElementsList:{},Params:{actionVar:"ACTION",productVar:"ID"},Add:function(id){var data={};data[this.Params.actionVar]="ADD",data[this.Params.productVar]=id,this.ElementsList[id]=id,this.SendRequest(data)},Delete:function(id){var data={};data[this.Params.actionVar]="DELETE",data[this.Params.productVar]=id,void 0!==this.ElementsList[id]&&delete this.ElementsList[id],this.SendRequest(data)},DeleteAll:function(){var data={};data[this.Params.actionVar]="FLUSH",this.ElementsList={},this.SendRequest(data)},SendRequest:function(data){var _this=this;(data=data||{}).sessid=BX.bitrix_sessid(),data.IS_MOBILE=isMobile?1:0,$.ajax({url:SITE_DIR+"ajax/sib/favorites.php",type:"POST",data:data,dataType:"html",success:function(res){_this.RefreshResult(res)}})},Refresh:function(){this.SendRequest()},RefreshButtons:function($node){"object"!=typeof $node&&($node=$(document));var obButtons=$node.find(".favorite-detail, button.action.favorite, .favorite-list-btn");if(obButtons.length){var btnSelector="";for(var id in this.ElementsList)btnSelector.length&&(btnSelector+=","),btnSelector+='[data-favorite-id="'+this.ElementsList[id]+'"]';if(btnSelector.length){var itemsIn=obButtons.filter(btnSelector),itemsNot=obButtons.not(itemsIn);itemsIn.length&&this.ButtonsViewStatus(itemsIn,!0,!0),itemsNot.length&&this.ButtonsViewStatus(itemsNot,!1,!0)}else this.ButtonsViewStatus(obButtons,!1,!0)}},ButtonsViewStatus:function(obButns,active,silent){var elementCount=Object.keys(this.ElementsList).length;silent=!!silent||!1,(active=!!active||!1)?obButns.addClass("toggled").attr("title",BX.message("BITRONIC2_FAVORITE_DELETE")):obButns.removeClass("toggled").attr("title",BX.message("BITRONIC2_FAVORITE_ADD")),obButns.closest(".actions-with-count").length&&obButns.closest(".actions-with-count").find(obButns).find("i").html(elementCount)},RefreshResult:function(res){isMobile?($(".favorite-desktop-result").html($(res).find(".favorite-desktop-result").html()),$(".rbs-favorite-count-mobile").html($(res).find(".rbs-favorite-count-mobile").html()),$(".js-del-btn-comp-fav[data-type='favorite']").off().on("click",(function(){RZB2.ajax.Favorite.Delete($(this).data("product-id"))}))):($(".favorite-desktop-result").html($(res).find(".favorite-desktop-result").html()),$(".rbs-favorite-count").html($(res).find(".rbs-favorite-count").html())),RZB2.utils.initLazy($(".favorite-desktop-result")),this.RefreshButtons()},ToBasket:{AddAll:function(){var data={items:{},action:"addList",rz_ajax:"y"};$('#popup_favorites table [name="quantity"]').each((function(){if(Number($(this).val())>0){var id=$(this).data("id"),quantity=Number($(this).val());data.items[id]={id:id,quantity:quantity}}})),this.SendRequest(data)},SendRequest:function(data){var _=this;$.ajax({url:SITE_DIR+"ajax/sib/basket_sib.php",type:"POST",data:data,dataType:"json",success:function(data){RZB2.ajax.BasketSmall.Refresh()}})}}},RZB2.ajax.BasketSmall={pricesTotal:{old:0,current:0},basketCurrency:"",addType:"buzz",ElementsList:{},addAnimation:function(silentMode){silentMode=!!silentMode;var basket=$("#basket");silentMode||basket.addClass("buzz");var currency=this.basketCurrency,target=basket.find("a .basket-total-price .value, .popup-header .basket-content .total-price .value, #popup_basket .popup-footer .price .value"),to=Number(this.pricesTotal.current),from=Number(this.pricesTotal.old),priceInterval;to=to%1<=0?parseInt(to):to,from=from%1<=0?parseInt(from):from;var stepInterval=35,steps=15,difference=to-from;steps>Math.abs(difference)&&(steps=parseInt(Math.abs(difference))),0==steps&&(steps=1);var step=difference/steps;to%1<=0&&from%1<=0&&(step=parseInt(step)),difference=difference>0?1:-1;var interval=setInterval((function(){var showPrice;((from+=step)-to)*difference>=0&&(from=to,basket.removeClass("buzz"),clearInterval(interval)),"object"==typeof BX.Currency&&currency.length?showPrice=BX.Currency.currencyFormat(from,currency,!1):(showPrice=from.toFixed(2))==Math.round(showPrice)&&(showPrice=Math.round(showPrice)),target.html(showPrice)}),35)},addPopup:function(params){var _this=this,data={rz_ajax:"y",action:"addPopup",id:params.id};void 0!==params.iblockId&&(data.iblock_id=params.iblockId),void 0!==params.iblockIdSku&&(data.iblock_id_sku=params.iblockIdSku),void 0!==params.parentId&&(data.parentId=params.parentId),this.ElementsList[params.id]=params.id;var $modal=$("#modal_basket"),$content=$modal.find(".content");$content.empty();var spinner=RZB2.ajax.spinner($modal.find(".modal-dialog"));spinner.Start({color:RZB2.themeColor}),$.ajax({url:SITE_DIR+"ajax/sib/basket_sib.php",type:"POST",data:data,dataType:"html",success:function(data){"object"==typeof spinner&&(spinner.Stop(),delete spinner),$content.html(data);var event=document.createEvent("HTMLEvents");event.initEvent("DOMContentLoaded",!0,!1),window.dispatchEvent(event),_this.RefreshButtons(),RZB2.utils.initLazy($content)}})},Refresh:function(silentMode,itemParams){var data={rz_ajax:"y",action:"updateBasket"},_this=this;$.ajax({url:SITE_DIR+"ajax/sib/basket_sib.php",type:"POST",data:data,dataType:"html",success:function(data){var basket=$("#basket"),$data=$(data);_this.pricesTotal.old=Number(basket.find(".basket-total__price").text());var replaceContentSelectors=[".basket-items",".basket-total__price",".header-basket__count>span",".header-basket__total"];"popup"==_this.addType&&(replaceContentSelectors.push("a .basket-total-price .value"),replaceContentSelectors.push(".popup-header .basket-content .total-price .value"),replaceContentSelectors.push("#popup_basket .popup-footer .price .value"));for(var i=0;i<replaceContentSelectors.length;i++)basket.find(replaceContentSelectors[i]).empty().html($data.find(replaceContentSelectors[i]).html());switch($(".header-basket__count>span").html($data.find(".header-basket__count>span").html()),_this.addType){case"popup":if(void 0!==itemParams&&void 0===window.recalcBasketAjax){void 0!==itemParams.id&&parseInt(itemParams.id)>0&&_this.addPopup(itemParams);break}case"buzz":default:_this.pricesTotal.current=Number(basket.find("#popup_basket .popup-footer .price").data("total-price")),_this.pricesTotal.current!=_this.pricesTotal.old&&_this.addAnimation(silentMode)}silentMode||"function"!=typeof window.recalcBasketAjax||recalcBasketAjax({},!0,"addItem"),$("<div></div>").html(data).empty(),RZB2.ajax.BasketSmall.RefreshButtons(),RZB2.utils.initLazy($(basket))}})},RefreshButtons:function($node){"object"!=typeof $node&&($node=$(document));var obButtons=$node.find("button.buy");if(obButtons.length){var btnSelector="";for(var id in this.ElementsList)btnSelector.length&&(btnSelector+=","),btnSelector+='[data-product-id="'+this.ElementsList[id]+'"]:not(.on-request),[data-offer-id="'+this.ElementsList[id]+'"]:not(.on-request)';if(btnSelector.length){var itemsIn=obButtons.filter(btnSelector),itemsNot=obButtons.not(itemsIn);itemsIn.length&&this.ButtonsViewStatus(itemsIn,!0,!0),itemsNot.length&&this.ButtonsViewStatus(itemsNot,!1,!0)}else this.ButtonsViewStatus(obButtons,!1,!0)}RZB2.ajax.RefreshTogglers(this.ElementsList,"#bxdinamic_bitronic2_basket_string","#popup_basket")},ButtonsViewStatus:function(obButns,active,silent){silent=!!silent||!1,(active=!!active||!1)?($(obButns).closest(".catalog-item").addClass("active"),obButns.each((function(){$(this).hasClass("button_white")?$(this).hasClass("rbs-buy")&&$(this).addClass("rbs-in-cart"):$(this).html('<div class="catalog__cart-ico"></div>')}))):($(obButns).closest(".catalog-item").removeClass("active"),obButns.each((function(){$(this).hasClass("button_white")?$(this).hasClass("rbs-buy")&&$(this).removeClass("rbs-in-cart"):$(this).html("В корзину")})))},Reload:function(data){data.rz_ajax="y",this.SendRequest(data)},SendRequest:function(data){var _this=this;$.ajax({url:SITE_DIR+"ajax/sib/basket_sib.php",type:"POST",data:data,dataType:"html",success:function(data){_this.Refresh(!0)}})},Delete:function(basketItemId,productId){var data={};data.id=basketItemId,data.quantity=0,data.rz_ajax="y",data.action="setQuantity",void 0!==this.ElementsList[productId]&&delete this.ElementsList[productId],this.SendRequest(data)},DeleteAll:function(obj){$(obj.target).parents("#popup_basket").find("input[name=quantity]").val(0);var data={action:"deleteAll"};this.ElementsList={},this.Reload(data)}},RZB2.ajax.CatalogSection={filterParams:{},GetFilterParamsString:function(){var notFirst=!1,urlParams="",delParams=["clear_cache","ajax"];for(var key in this.filterParams)BX.util.in_array(key,delParams)||BX.util.in_array(key,BX.util.array_keys(RZB2.ajax.params))||BX.util.in_array(key,BX.util._array_values_ob(RZB2.ajax.params))||(notFirst&&(urlParams+="&"),notFirst=!0,urlParams+=key+"="+encodeURIComponent(this.filterParams[key]));return urlParams},GetCommonParamsString:function(){var notFirst=!1,urlParams="";for(var key in RZB2.ajax.params)if(RZB2.ajax.params[key].length)switch(key){case"page_count":case"view":case"sort":case"by":case"spec":case"rz_all_elements":case"q":case"where":case"section":notFirst&&(urlParams+="&"),urlParams+=key+"="+RZB2.ajax.params[key],notFirst=!0}return urlParams},Start:function(obj,Params,spinnerParams){for(var key in Params)key.length&&(RZB2.ajax.params[key]=Params[key]);var spinner=RZB2.ajax.spinner($(obj));return this.Reload(spinner,Params)},Reload:function(spinner,params){var objLoader=$("#catalog_section"),data={rz_ajax:"y",site_id:SITE_ID};for(var key in RZB2.ajax.params)data[key]=RZB2.ajax.params[key];return this.SendRequest(data,objLoader,params,spinner)},SendRequest:function(data,objLoader,params,spinner){RZB2.ajax.loader.Start(objLoader,!0);var paramFilterString=this.GetFilterParamsString();return this.SetNewLocation(),"MORE_CLICK"in(params=params||{})||RZB2.ajax.scrollPage($(".box-bread-crumbs")),$.ajax({url:SITE_DIR+"ajax/sib/catalog.php?"+paramFilterString,type:"POST",data:data,dataType:"html",success:function(data){RZB2.ajax.loader.Stop(objLoader),RZB2.ajax.CatalogSection.Refresh(data,params)}})},SetNewLocation:function(){var paramCommonString=this.GetCommonParamsString(),paramFilterString=this.GetFilterParamsString(),newLocation=window.location.pathname;"SefSetUrl"in this&&this.SefSetUrl.length>0?newLocation=this.SefSetUrl+"?"+paramCommonString:paramCommonString.length?(newLocation+="?"+paramCommonString,paramFilterString.length&&(newLocation+="&"+paramFilterString)):paramFilterString.length&&(newLocation+="?"+paramFilterString),RZB2.ajax.setLocation(newLocation)},Refresh:function(data,params){var $data=$(data),catalogClass="table"==RZB2.ajax.params.view?"catalog-table":RZB2.ajax.params.view,$catalogSection=$("#catalog_section");if($catalogSection.find(".box-paging").remove(),$catalogSection.find(".rbs-section-description-block").remove(),$catalogSection.find(".timer").each((function(){$(this).off().countdown("pause")})),$catalogSection.removeClass("blocks list catalog-table").addClass(catalogClass),"MORE_CLICK"in params){var $lastItem=$catalogSection.find(".catalog-item").last(),curOffset=$lastItem.offset().top;if("table"==RZB2.ajax.params.view){var $headerArt=$catalogSection.find(".table-header .art-wrap");$headerArt.hasClass("no-art")&&$data.find("#catalog_section td.art-wrap").each((function(){return!!$(this).hasClass("no-art")||($headerArt.removeClass("no-art"),!1)})),$catalogSection.find("table").append($data.find("#catalog_section table").html().trim())}else"blocks"==catalogClass&&($data.find("#catalog_section.catalog-page-wrap > div").not(".catalog-item-wrap").css("display","inline"),$catalogSection.children("div").not(".catalog-item-wrap").css("display","inline")),$catalogSection.append($data.find("#catalog_section").html().trim())}else $catalogSection.empty().html($data.find("#catalog_section").html());var paginatorSelector=".pagination",paginatorTextSelector=".current-state";$data.find(".pagination").length?$(".pagination").empty().html($data.find(".pagination").html()):$(".pagination").empty(),$data.find(".current-state").length?$(".current-state").empty().html($data.find(".current-state").html()):$(".current-state").empty();var $paginatorMore=$data.find(".more-catalog-wrap"),tableHeader,exe;if(($paginatorMore.length>0?$($paginatorMore.selector).empty().html($paginatorMore.html()):$paginatorMore.empty(),$data.find("span.view-type a").each((function(){$('div.catalog-main-content a[data-view="'+$(this).data("view")+'"]').attr("href",$(this).attr("href"))})),"table"==RZB2.ajax.params.view)&&$(".table-header").length){var el=$(".table-header"),wrap=el.closest(".catalog"),offBot=50,thScrollFix=new UmScrollFix(el,wrap,0,50);thScrollFix.getDims(),thScrollFix.update()}RZB2.ajax.Compare.RefreshButtons(),RZB2.ajax.Favorite.RefreshButtons(),RZB2.ajax.BasketSmall.RefreshButtons(),RZB2.ajax.CatalogSection.RefreshButtons(),RZB2.utils.initLazy($catalogSection),setTimeout((function(){$(".rbs-find-img-detail-descr").length&&$(".rbs-find-img-detail-descr").lazyload({}).removeClass("placeholder"),"function"==typeof checkBannerSection&&checkBannerSection()}),300),$("<div></div>").html(data),"MORE_CLICK"in params&&$("html,body").animate({scrollTop:window.pageYOffset+$lastItem.offset().top-curOffset},0)},RefreshButtons:function(){var itemCount=$(".catalog-page .catalog-item").length,totalCount=parseInt($("div.catalog-main-content .current-state-total").eq(0).text());isNaN(totalCount)&&(totalCount=0),$(".catalog-page").find(".view-type, .sort-list, .sort-n-view.for-catalog .chosen-container").toggleClass("disabled",!itemCount);var $showBy=$(".catalog-page .show-by select.show-by"),$options=$showBy.find("option"),arDisabled=[],arEnabled=[0];$showBy.eq(0).find("option").each((function(index){var $_=$(this);index>=arEnabled.length&&($_.is(":selected")?arEnabled.push(index):arDisabled.push(index)),totalCount>parseInt($_.val())&&index+1<$options.length&&arEnabled.push(index+1)})),$showBy.find("option").filter((function(index,el){return $.inArray(index,arDisabled)>-1})).prop("disabled",!0),$showBy.find("option").filter((function(index,el){return $.inArray(index,arEnabled)>-1})).prop("disabled",!1)},AddToBasketSimple:function(id,iblock_id,quantity,spinner){var data={items:{},action:"addList",rz_ajax:"y"};Number(id)>0&&(isNaN(quantity)&&(quantity=1),data.items[id]={id:id,iblockId:iblock_id,quantity:quantity},this.Table.SendRequest(data,spinner))},Table:{AddToBasket:function(obj,spinnerParams){var data={items:{},action:"addList",rz_ajax:"y"};data.iblock_id=RZB2.ajax.params.IBLOCK_ID,$('#catalog_section table [name="quantity"]').each((function(){if(Number($(this).val())>0){var id=$(this).data("item-id"),quantity=Number($(this).val());data.items[id]={id:id,quantity:quantity}}}));var spinner=RZB2.ajax.spinner($(obj));spinner.Start(spinnerParams),this.SendRequest(data,spinner)},SendRequest:function(data,spinner){var _=this;$.ajax({url:SITE_DIR+"ajax/sib/basket_sib.php",type:"POST",data:data,dataType:"json",success:function(_data){var counter=0;for(var item in data.items)RZB2.ajax.BasketSmall.ElementsList[item]=item,counter++;1==counter?RZB2.ajax.BasketSmall.Refresh(!1,data.items[item]):RZB2.ajax.BasketSmall.Refresh(),RZB2.ajax.BasketSmall.RefreshButtons(),_.ClearInputs(),"object"==typeof spinner&&(spinner.Stop(),delete spinner)}})},ClearInputs:function(){$('#catalog_section table [name="quantity"]').val(0),$("#add_basket_table .number").text(0),$("#add_basket_table").addClass("disabled"),$(".quantity-counter .btn-silver.quantity-change.decrease").addClass("disabled")}}},RZB2.ajax.BigBasket={AddToBasket:function(id){var data={items:{},action:"addList",rz_ajax:"y"};Number(id)>0&&(data.items[id]={id:id,quantity:1},this.SendRequest(data))},SendRequest:function(data){var _=this;$.ajax({url:SITE_DIR+"ajax/sib/basket_sib.php",type:"POST",data:data,dataType:"json",success:function(res){recalcBasketAjax({},!0,"addItem")}})}},RZB2.ajax.FormUnified=function(arParams){this.modalId="",this.ajaxPath="","object"==typeof arParams&&(this.modalId=arParams.ID,this.ajaxPath=arParams.AJAX_FILE)},RZB2.ajax.FormUnified.prototype.Load=function(params,callback){var $form=$("#"+this.modalId).find(".content");$form.empty();var data=params=params||[];this.SendRequest(data,$form,!1,callback)},RZB2.ajax.FormUnified.prototype.Post=function($form,callback,close,refresh){var data=$form.serializeArray();close=void 0===close||!!close,refresh=void 0!==refresh&&!!refresh,this.SendRequest(data,$form,close,callback,refresh)},RZB2.ajax.FormUnified.prototype.SendRequest=function(data,objLoad,close,callback,refresh){refresh=void 0===refresh||!!refresh,void 0===data&&(data=[]),data.push({name:"rz_ajax",value:"Y"});var _this=this;objLoad.find(".button").length&&objLoad.find(".button").addClass("disabled");var spinner=RZB2.ajax.spinner(objLoad);if(!RZB2.utils.checkPrivityPolicy(objLoad))return!1;spinner.Start({color:RZB2.themeColor}),$.ajax({type:"POST",url:this.ajaxPath,data:data,success:function(res){_this.Refresh(res,objLoad,close,spinner,refresh),objLoad.find(".button").length&&objLoad.find(".button").removeClass("disabled"),"function"==typeof callback&&callback(res)}})},RZB2.ajax.FormUnified.prototype.Refresh=function(res,objLoad,close,spinner,refresh){close&&($("#"+this.modalId).find("[data-fancybox-close]").click(),"function"==typeof recalcBasketAjax&&recalcBasketAjax(),RZB2.ajax.BasketSmall.Refresh(!0)),"object"==typeof spinner&&(spinner.Stop(),delete spinner),refresh?(objLoad.html(res),RZB2.utils.initLazy($(objLoad))):$("<div></div>").html(res).empty().remove()},$.fn.rise_modal=function(add_data){void 0===add_data&&(add_data=[]);var $form=this,data=[];return add_data.length>0&&(data=$.merge(data,add_data)),data.push({name:"ajax",value:$form.data("ajax")}),data.push({name:"rz_option_name",value:$form.data("rzoption")}),$.ajax({type:"POST",url:SITE_DIR+"ajax/sib/detail_modals.php",data:data,success:function(msg){$form.html(msg)}})},$.fn.send_modal=function(add_data){void 0===add_data&&(add_data=[]);var $form=this,data=$form.serializeArray();return add_data.length>0&&(data=$.merge(data,add_data)),data.push({name:"ajax",value:$form.data("ajax")}),$.ajax({type:"POST",url:SITE_DIR+"ajax/sib/detail_modals.php",data:data,success:function(msg){$form.html(msg)}})},RZB2.ajax.updateCatalogParametersCache=function(callback){return $.get(SITE_DIR+"catalog/",{rz_update_catalog_parameters_cache:"Y"},(function(){"function"==typeof callback&&callback()}))};