$(window).on("b2ready",function(){var timerQuantity,timerTimeout;$("#popup_compare").on("click",".table-wrap button.btn-delete",function(e){e.preventDefault(),RZB2.ajax.Compare.Delete($(this).data("id"))}),$("#popup_compare").on("click",".popup-footer button.btn-delete",function(e){e.preventDefault(),RZB2.ajax.Compare.DeleteAll()}),RZB2.ajax.Compare.RefreshButtons(),$("#popup_favorites").on("click",".table-wrap button.btn-delete",function(e){e.preventDefault(),RZB2.ajax.Favorite.Delete($(this).data("id"))}),$("#popup_favorites").on("click",".popup-footer button.btn-delete",function(e){e.preventDefault(),RZB2.ajax.Favorite.DeleteAll()}),$("#popup_favorites").on("click",".popup-footer button.btn-main",function(e){e.preventDefault(),RZB2.ajax.Favorite.ToBasket.AddAll()}),RZB2.ajax.Favorite.RefreshButtons(),$("#popup_basket .basket-content").on({mousedown:function(e){e=e||window.event;var _=$(this),quanInput=_.siblings(".quantity-input");if(!(quanInput.hasClass("disabled")||quanInput.is(":disabled")||_.hasClass("disabled"))){var curValue=Number(quanInput.val()),ratio=parseFloat(quanInput.data("ratio")),changeStep=ratio;_.hasClass("decrease")&&(changeStep=-ratio),(isNaN(curValue)||curValue<1)&&(curValue=ratio),(curValue+=changeStep)<ratio&&(curValue=ratio),quanInput.val(curValue),timerTimeout=setTimeout(function(){timerQuantity=setInterval(function(){(curValue+=changeStep)<ratio&&(curValue=ratio),quanInput.val(curValue)},100)},300),_.data("changed",!0)}},"mouseup mouseleave":function(e){clearTimeout(timerTimeout),clearInterval(timerQuantity),$(this).data("changed")&&RZB2.ajax.BasketSmall.ChangeQuantity(e)}},"button.quantity-change").on("change","input[name=quantity]",function(e){RZB2.ajax.BasketSmall.ChangeQuantity(e)}).on("click","button.btn-delete",function(e){(e=e||window.event).preventDefault(),RZB2.ajax.BasketSmall.Delete(e)}),$("#popup_basket .popup-footer").on("click","button.btn-delete",function(e){(e=e||window.event).preventDefault(),RZB2.ajax.BasketSmall.DeleteAll(e)}),RZB2.ajax.BasketSmall.RefreshButtons();var smallSpinnerParams={radius:3,width:2};$(".catalog-page .show-by select.show-by").on("change",function(e){e.stopPropagation();var $select=$(".catalog-page .show-by select.show-by");$select.find('option[value="'+$(this).val()+'"]').prop("selected",!0),$select.ikSelect("reset"),RZB2.ajax.CatalogSection.Start(this,{page_count:$(this).val()})}),$(".catalog-page .sort-n-view .view-type a").on("click",function(e){e.stopPropagation(),e.preventDefault();var $_=$(this);$_.hasClass("active")||($_.addClass("active").siblings("a").removeClass("active"),RZB2.ajax.CatalogSection.Start(this,{view:$_.data("view")},smallSpinnerParams))}),$(".catalog-page .pagination").on("click","a",function(e){if(e.preventDefault(),e.stopPropagation(),!$(this).hasClass("active")){var pagenKey=$(this).attr("data-pagen-key"),params={};params[$(this).attr("data-pagen-key")]=$(this).attr("data-page"),RZB2.ajax.CatalogSection.Start(this,params,smallSpinnerParams)}}),$(".catalog-page").on("click",".more-catalog",function(e){if(e.preventDefault(),e.stopPropagation(),!$(this).hasClass("disabled")){var pagenKey=$(this).attr("data-pagen-key"),params={};params[$(this).attr("data-pagen-key")]=$(this).attr("data-page"),params.MORE_CLICK=1,RZB2.ajax.CatalogSection.Start($(this).find(".btn-plus"),params)}}),$(".catalog-page #sort-by").on("change",function(e){var sortItem=$(this).find("option:selected");RZB2.ajax.CatalogSection.Start(this,{sort:sortItem.data("sort"),by:sortItem.data("sort-by")},smallSpinnerParams)}),$(".catalog-page ul.sort-list li").on("click",function(e){$(this).hasClass("active")&&("asc"==$(this).data("sort-by")?$(this).data("sort-by","desc"):$(this).data("sort-by","asc")),RZB2.ajax.CatalogSection.Start(this,{sort:$(this).data("sort"),by:$(this).data("sort-by")},smallSpinnerParams)}),$(".catalog-page").on("click","#add_basket_table",function(e){$(this).css("position","relative").addClass("disabled"),RZB2.ajax.CatalogSection.Table.AddToBasket(this,{radius:5,color:RZB2.themeColor,top:"45%"})}),$(".calc-delivery").on("click",function(e){var _=$(this);e.preventDefault(),edost_catalogdelivery_show(_.data("id"),_.data("name"))}),RZB2.ajax.Review.Blog.Refresh(),$("#comments").on("submit","#form_comment_blog",function(e){e.preventDefault();var $this=$(this),data=$this.serializeArray();RZB2.ajax.Review.Blog.SendRequest($this,data,!1)}),$("#comments").on("click","#blog_comments .pagination a",function(e){e.preventDefault();var $this=$(this);$this.hasClass("active")||RZB2.ajax.Review.Blog.ChangePage($this,$this.data("page"))}),RZB2.ajax.Review.Forum.Refresh(),$("#comments").on("submit","#form_comment_forum",function(e){e.preventDefault();var $this,data=$(this).serializeArray();RZB2.ajax.Review.Forum.SendRequest(data)}),$("#comments").on("click","#forum_comments .pagination a",function(e){e.preventDefault();var $this=$(this);$this.hasClass("active")&&$this.hasClass("disabled")||RZB2.ajax.Review.Forum.ChangePage($this.data("page"),$this.data("pagen-key"))}),$(".contacts-content").on("click",".phone-link",function(e){Modernizr.mq("(max-width: 767px)")||(e.preventDefault(),$("#modal_callme").modal("show"),void 0===RZB2.ajax.callMe&&(RZB2.ajax.callMe=new RZB2.ajax.FormUnified({ID:"modal_callme",AJAX_FILE:SITE_DIR+"ajax/sib/callme.php"})),RZB2.ajax.callMe.Load())}),$("#modal_callme").on("submit","form",function(e){e.preventDefault(),RZB2.ajax.callMe.Post($(this))}),$(document).on("click",".feedback-link",function(e){e.preventDefault(),$("#modal_feedback").modal("show"),void 0===RZB2.ajax.feedBack&&(RZB2.ajax.feedBack=new RZB2.ajax.FormUnified({ID:"modal_feedback",AJAX_FILE:SITE_DIR+"ajax/sib/feedback.php",URL:location.pathname})),RZB2.ajax.feedBack.Load()}),$("#modal_feedback").on("submit","form",function(e){e.preventDefault(),RZB2.ajax.feedBack.Post($(this))}),$("#search").on("click","button.btn-buy",function(e){if(e.preventDefault(),$(this).hasClass("main-clicked")&&$(this).hasClass("forced"))location.href=$("#bxdinamic_bitronic2_basket_string").attr("href");else{var spinner=RZB2.ajax.spinner($(this));spinner.Start(smallSpinnerParams),RZB2.ajax.CatalogSection.AddToBasketSimple($(this).data("product-id"),1,spinner)}}).on("change","#search-area",function(e){var _=$(this),$form=_.closest("form");_.find("option").each(function(){var category="category_"+$(this).data("category");$(this).val()==_.val()?$form.addClass(category):$form.removeClass(category)}),setTimeout(function(){$("#popup_ajax-search").velocity("finish"),$("#search-field").focus()},50)}),$(".card-main-aside, .product-page, .catalog-page, .special-blocks, .search-results-page, .basket-big-page, .small-basket-buy-wrap").on("click",".one-click-buy",oneClickBuyHandler),$(".viewed-products").find(".one-click-buy").on("click",function(e){$($(this).data("target")).modal("show"),oneClickBuyHandler.call(this,e)}),$("#modal_quick-buy").on("submit","form",function(e){e.preventDefault(),RZB2.ajax.oneClick.Post($(this))}),$(".product-page").on("click",".collection-wrap .btn-main",function(e){e.preventDefault(),RZB2.ajax.CatalogSetConstructor.AddToBasket(this)}),$(".product-page").on("click",".custom-collection",function(e){e.preventDefault(),void 0!==RZB2.ajax.SetConstructor&&RZB2.ajax.SetConstructor.Load()}),"object"==typeof RZB2.ajax.quickView&&$("#modal_quick-view").on("shown.bs.modal",RZB2.ajax.quickView.onModalShown).on("hidden.bs.modal",RZB2.ajax.quickView.onModalHidden);var $doc=$(document);$.fn.rise_modal=function(add_data){void 0===add_data&&(add_data=[]);var $form=this,data=[];add_data.length>0&&(data=$.merge(data,add_data));var spinner={};return void 0===$form.data("spinner")?(spinner=RZB2.ajax.spinner($form),$form.data("spinner",spinner)):spinner=$form.data("spinner"),spinner.Start({color:RZB2.themeColor}),data.push({name:"ajax",value:$form.data("ajax")}),$.ajax({type:"POST",url:SITE_DIR+"ajax/sib/detail_modals.php",data:data,success:function(msg){$form.html(msg),spinner.Stop()}})},$.fn.send_modal=function(add_data){void 0===add_data&&(add_data=[]);var $form=this,data=$form.serializeArray();add_data.length>0&&(data=$.merge(data,add_data));var spinner={};return void 0===$form.data("spinner")?(spinner=RZB2.ajax.spinner($form),$form.data("spinner",spinner)):spinner=$form.data("spinner"),spinner.Start({color:RZB2.themeColor}),data.push({name:"ajax",value:$form.data("ajax")}),$.ajax({type:"POST",url:SITE_DIR+"ajax/sib/detail_modals.php",data:data,success:function(msg){$form.html(msg),spinner.Stop()}})};var $mcfp=$("#modal_cry-for-price");$mcfp.length>0&&$mcfp.on("shown.bs.modal",function(e){var $btn=$(e.relatedTarget),data=[{name:"PRICE",value:$btn.data("price")},{name:"CURRENCY",value:$btn.data("currency")},{name:"PRODUCT",value:$btn.data("product")},{name:"PRICE_TYPE",value:$btn.data("price_type")}];$(this).find("form").rise_modal(data)}),$doc.on("submit",".form_cry-for-price",function(e){var $this=$(this);return!!formCheck($this)&&(e.preventDefault(),$this.send_modal(),!1)});var $miwpd=$("#modal_inform-when-price-drops");$miwpd.length>0&&$miwpd.on("shown.bs.modal",function(){var $form=$(this).find("form"),$btn=$("#button_price_drops"),data=[{name:"PRICE",value:$btn.data("price")},{name:"CURRENCY",value:$btn.data("currency")},{name:"PRODUCT",value:$btn.data("product")},{name:"PRICE_TYPE",value:$btn.data("price_type")}];$.when($form.rise_modal(data)).then(function(){var moneyFormat=wNumb({mark:".",thousand:" ",decimals:2}),thisModal=$("#modal_inform-when-price-drops"),currentPriceField=$("#price-current").children(".value"),currentPrice=moneyFormat.from(currentPriceField.html());thisModal.on("show.bs.modal",function(){currentPrice=moneyFormat.from(currentPriceField.html())});var npSlider=$(".desired-price-slider").noUiSlider({start:.9*currentPrice,connect:"lower",step:1,range:{min:1,max:currentPrice},format:moneyFormat});npSlider.Link("lower").to($("#desired-price>.value")),npSlider.Link("lower").to($("#modal_inform-when-price-drops_price"));var desiredPriceField=$("#desired-price").children(".value"),priceDifferenceField=$("#price-difference").children(".value"),priceDifferencePercentField=$("#price-difference").children(".percent-value"),desiredPrice=moneyFormat.from(desiredPriceField.html()),priceDifference=currentPrice-desiredPrice,priceDifferencePercent=Number(priceDifference/currentPrice*100).toFixed(2);function setDifference(){priceDifferenceField.html(moneyFormat.to(priceDifference)),priceDifferencePercentField.html("("+priceDifferencePercent+"%)")}setDifference(),npSlider.on("slide set",function(){desiredPrice=moneyFormat.from($(this).val()),priceDifference=currentPrice-desiredPrice,priceDifferencePercent=Number(priceDifference/currentPrice*100).toFixed(2),setDifference()})})}),$doc.on("keypress","#modal_inform-when-price-drops_price",function(e){return 13!==e.which||($(this).change(),!1)}),$doc.on("keypress","#modal_inform-when-price-drops_email",function(e){return 13!==e.which||($("#modal_inform-when-price-drops_price").focus(),!1)}),$doc.on("submit",".form_inform-when-price-drops",function(e){var $this=$(this);return!!formCheck($this)&&(e.preventDefault(),$this.send_modal(),!1)});var $msp=$("#modal_subscribe_product");$msp.length>0&&$msp.on("shown.bs.modal",function(e){var $btn,data=[{name:"PRODUCT",value:$(e.relatedTarget).data("product")}];$(this).find("form").rise_modal(data)}),$doc.on("submit","#modal_subscribe_product_form",function(e){var $this=$(this);return!!formCheck($this)&&(e.preventDefault(),$this.send_modal(),!1)}),$(document).on("hitstoggle",RZB2.visual.Hits.ToggleShow),RZB2.visual.Hits.InitShow(),$("main.compare-page").on("click",".remove-property",function(e){e.preventDefault();var _=$(this),spinner=RZB2.ajax.spinner(_.closest("th, td"));spinner.Start({width:2,radius:5,color:RZB2.themeColor}),RZB2.ajax.ComparePage.SendRequest(_,function(res){spinner.Stop(),delete spinner;var tr=_.closest("tr"),tbody=tr.parent("tbody"),trClass=tr.attr("class"),scroller=$(".compare-outer-wrapper .scroller");scroller.height(scroller.height()-tr.height()),$(".compare-table tr."+trClass).remove(),tbody.length>0&&tbody.children().not(".section-header").length<1&&(scroller.height(scroller.height()-tbody.height()),$(".compare-table tbody."+tbody.attr("class")).remove());var $res,$deletedRes=$(res).find(".deleted-properties"),$deletedDiv=$(".deleted-properties");$deletedDiv.length>0?$deletedDiv.html($deletedRes.html()):$("main.compare-page").append($deletedRes)})}).on("click",".compare-switch, .compare-item .btn-close, .deleted-property a",function(e){var spinner;e.preventDefault(),RZB2.ajax.spinner($(this)).Start({width:2,radius:5});var $container=$("main.compare-page");RZB2.ajax.loader.Start($container),RZB2.ajax.ComparePage.SendRequest($(this),function(res){$body.off(".b2comparepage"),$(window).off(".b2comparepage");var $res,$main=$("<div>"+res+"</div>").find("main.compare-page");$container.html($main.html()),initComparePage(),$(window).trigger("scroll.b2comparepage").trigger("b2ready"),RZB2.ajax.BasketSmall.RefreshButtons(),RZB2.ajax.loader.Stop($container)})})});var oneClickBuyHandler=function(e){e.preventDefault();var $this=$(this);void 0===RZB2.ajax.oneClick&&(RZB2.ajax.oneClick=new RZB2.ajax.FormUnified({ID:"modal_quick-buy",AJAX_FILE:SITE_DIR+"ajax/sib/one_click.php"})),RZB2.ajax.oneClick.Load([{name:"id",value:$this.data("id")},{name:"RZ_BASKET",value:$this.data("basket")},{name:"PROPS",value:$this.data("props")}])};