b2.init.buyClick=function(){var ttTimeout;b2.el.$basket=$("#basket"),$(document).find("button.buy, a.buy").on("click",function(e){switch(e.preventDefault(),b2.s.actionOnBuy){case"animation-n-popup":var _=$(this);if(_.hasClass("disabled"))return;var root=_.closest(".catalog-item"),price,img;if(root.length)price=root.find(".price-value").html();else{if(!(root=_.closest(".buy-block-content")).length){if(!(root=_.closest(".slider-item")).length)break;price=root.find(".price-value").html()}img=root.find(".product-main-photo>img"),price=root.find(".price>.value").html()}if(!price)break;price=formatRub.from(price);var quantity=parseFloat(root.find(".quantity-input").val());quantity||(quantity=1);var totalPrice=quantity*price;img||(img=root.find(".photo img"));var tt=_.next(".tooltip");fly(img,b2.el.$basket),addToBasket(b2.el.$basket,totalPrice,1),isHover&&(0===tt.length?(_.tooltip({trigger:"focus",html:!0,title:'<i class="flaticon-43"></i>\t\t\t\t\t\t\t\t\t<div class="text">Товар добавлен в корзину</div>\t\t\t\t\t\t\t\t\t<a href="basket-big.php" class="link">\t\t\t\t\t\t\t\t\t\t<span class="text">Оформить заказ</span\t\t\t\t\t\t\t\t\t</a>',template:'\t\t\t\t\t\t\t<div class="tooltip buy-popup" role="tooltip">\t\t\t\t\t\t\t\t<div class="tooltip-arrow"></div>\t\t\t\t\t\t\t\t<div class="tooltip-inner"></div>\t\t\t\t\t\t\t</div>'}).one("shown.bs.tooltip",function(){(tt=_.next(".tooltip")).hover(function(){clearTimeout(ttTimeout)},function(){ttTimeout=setTimeout(function(){_.tooltip("destroy")},4e3)})}).one("hidden.bs.tooltip",function(){clearTimeout(ttTimeout),_.tooltip("destroy")}).tooltip("show").one("keyup",function(e){27===e.keyCode&&(clearTimeout(ttTimeout),e.stopImmediatePropagation(),_.tooltip("destroy"))}),ttTimeout=setTimeout(function(){_.tooltip("destroy")},4e3)):(clearTimeout(ttTimeout),ttTimeout=setTimeout(function(){_.tooltip("destroy")},4e3)));break;case"open-modal-basket":$("#modal_basket").modal("show");break;case"go-to-big-basket":window.location.href="basket-big.php";break;default:console.log("problems in button.buy click")}})};