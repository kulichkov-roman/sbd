function SitenavMenu(menu){var self=this,$wrap=$(".sitenav-wrap"),$sitenav=$wrap.find(".sitenav-menu"),bullet='<span class="bullet">â€¢</span>',item="sitenav-menu-item",$items=$sitenav.find("."+item),collapse=$('<div class="'+item+' with-sub addsItems" />'),bullets=$('<div class="bullets">'+bullet+bullet+bullet+"</div>"),list=$('<ul class="submenu" />'),updating=!1,addsItems,timeout,resetTimeout,resizeTimeout;function resizeHandler(){if("collapse"===b2.s.sitenavType){if(updating)return;updating=!0,self.resetHandlers(),updating=!1}}menu.on("click",".sitenav-menu-item.with-sub > a, .sitenav-menu-item.with-sub > .sitenav-header a, .addsItems .submenu .with-sub > a, .addsItems .submenu .with-sub > .sitenav-header a",function(e){if(!isMobile&&isTouch){var $link=$(this);e.preventDefault();var $submenu=$link.closest(".with-sub");return menu.find(".with-sub.opened").not($submenu).length&&menu.find(".with-sub.opened").not($submenu).each(function(){var $t=$(this);$.contains(this,$submenu[0])||$t.removeClass("opened")}),$submenu.toggleClass("opened"),!1}}),menu.on("click",".sitenav-menu-item.addsItems .bullets",function(e){if(!isMobile&&isTouch){var $submenu=$(this).siblings(".submenu");return menu.find(".with-sub.opened").not($submenu).length&&menu.find(".with-sub.opened").not($submenu).each(function(){var $t=$(this);$.contains(this,$submenu[0])||$t.removeClass("opened")}),$submenu.parent().toggleClass("opened"),!1}}),$(document).mouseup(function(e){!isMobile&&isTouch&&(menu.is(e.target)||0!==menu.has(e.target).length||menu.find(".with-sub.opened").length&&menu.find(".with-sub.opened").each(function(){var $t;$(this).removeClass("opened")}))}),this.resetHandlers=function(){clearTimeout(resetTimeout),resetTimeout=setTimeout(function(){self.updateState()},10)},this.resetItems=function(){addsItems&&($items=$items.add(addsItems.addClass(item)),addsItems.appendTo($sitenav),collapse.detach(),addsItems=null),$sitenav.closest(".sitenav").removeClass("menu-collapse").removeClass("shown")},this.updateState=function(){self.resetItems(),clearTimeout(timeout),timeout=setTimeout(function(){if(menu.removeClass("touch-menu"),!isMobile&&isTouch&&menu.addClass("touch-menu"),!Modernizr.mq("(max-width: 767px)")&&"collapse"===b2.s.sitenavType&&($sitenav.closest(".sitenav").addClass("menu-collapse"),$items=$sitenav.find("."+item),$sitenav.width()>$wrap.width()))for(var i=$items.length-1;i>=0;i--)if($items.eq(i).position().left+$items.eq(i).width()<=$wrap.width()-40){$sitenav.closest(".sitenav").addClass("shown"),(addsItems=$items.slice(i)).each(function(){$(this).removeClass(item)}),bullets.appendTo(collapse),addsItems.appendTo(list),list.appendTo(collapse),collapse.appendTo($sitenav.closest(".sitenav"));break}},10)},$(window).on("resize.sitenav",function(){clearTimeout(resizeTimeout),resizeTimeout=setTimeout(resizeHandler,150)})}