!function(window){if(!window.JCCatalogItem){var BasketButton=function(params){BasketButton.superclass.constructor.apply(this,arguments),this.nameNode=BX.create("span",{props:{className:"bx_medium bx_bt_button",id:this.id},style:"object"==typeof params.style?params.style:{},text:params.text}),this.buttonNode=BX.create("span",{attrs:{className:params.ownerClass},style:{marginBottom:"0",borderBottom:"0 none transparent"},children:[this.nameNode],events:this.contextEvents}),BX.browser.IsIE()&&this.buttonNode.setAttribute("hideFocus","hidefocus")};BX.PopupWindowButton&&BX.extend(BasketButton,BX.PopupWindowButton),window.JCCatalogItem=function(arParams){if(this.skuVisualParams={TEXT:{TAG_BIND:"select",TAG:"option",CLASS:"",ACTIVE_CLASS:"active",HIDE_CLASS:"bx_missing",EVENT:"change"},PICT:{TAG_BIND:"span",TAG:"span",CLASS:"color",ACTIVE_CLASS:"active",HIDE_CLASS:"bx_missing",EVENT:"click"},BOX:{TAG_BIND:"span",TAG:"span",CLASS:"color",ACTIVE_CLASS:"active",HIDE_CLASS:"bx_missing",EVENT:"click"}},this.viewedCounter={path:"/bitrix/components/bitrix/catalog.element/ajax.php",params:{AJAX:"Y",SITE_ID:"",PRODUCT_ID:0,PARENT_ID:0}},this.updateViewedCount=!1,this.currentIsSet=!1,this.productType=0,this.showQuantity=!0,this.showAbsent=!0,this.secondPict=!1,this.showOldPrice=!1,this.showPercent=!1,this.showSkuProps=!1,this.showOfferGroup=!1,this.bigData=!1,this.basketAction="ADD",this.showClosePopup=!1,this.useCompare=!1,this.useFavorite=!1,this.hasServices=!1,this.serviceIblockID=0,this.articul="",this.visual={ID:"",PICT_ID:"",SECOND_PICT_ID:"",QUANTITY_ID:"",QUANTITY_UP_ID:"",QUANTITY_DOWN_ID:"",PRICE_ID:"",PRICE_OLD_ID:"",DSC_PERC:"",SECOND_DSC_PERC:"",ARTICUL_ID:"",DISPLAY_PROP_DIV:"",BASKET_PROP_DIV:"",OFFER_GROUP:""},this.product={checkQuantity:!1,maxQuantity:0,stepQuantity:1,isDblQuantity:!1,canBuy:!0,canSubscription:!0,name:"",pict:{},id:0,addUrl:"",buyUrl:""},this.basketMode="",this.basketData={useProps:!1,emptyProps:!1,inputProps:!1,quantity:"quantity",props:"prop",basketUrl:"",sku_props:"",sku_props_var:"basket_props",add_url:"",buy_url:""},this.compareData={compareUrl:"",comparePath:""},this.favoriteData={Url:"",UrlDel:"",Path:""},this.defaultPict={pict:null,secondPict:null},this.checkQuantity=!1,this.maxQuantity=0,this.minQuantity=1,this.stepQuantity=1,this.isDblQuantity=!1,this.canBuy=!0,this.currentBasisPrice={},this.canSubscription=!0,this.precision=6,this.precisionFactor=Math.pow(10,this.precision),this.priceMatrix=!1,this.offers=[],this.offerNum=0,this.countSkuChangeUrl=0,this.treeProps=[],this.obTreeRows=[],this.showCount=[],this.showStart=[],this.selectedValues={},this.obProduct=null,this.obQuantity=null,this.obQuantityUp=null,this.obQuantityDown=null,this.obPict=null,this.obSecondPict=null,this.obPrice=null,this.obTree=null,this.obBuyBtn=null,this.obRequestBtn=null,this.obBasketActions=null,this.obAvailInfo=null,this.obAvailInfoMobile=null,this.obDscPerc=null,this.obSecondDscPerc=null,this.obSkuProps=null,this.obMeasure=null,this.obCompare=null,this.obArticul=null,this.obPopupWin=null,this.basketUrl="",this.basketParams={},this.treeRowShowSize=5,this.treeEnableArrow={display:"",cursor:"pointer",opacity:1},this.treeDisableArrow={display:"",cursor:"default",opacity:.2},this.lastElement=!1,this.containerHeight=0,this.errorCode=0,"object"==typeof arParams){switch(this.detail=!!arParams.DETAIL,this.quickView=!!arParams.QUICK_VIEW,this.detail&&(this.skuSimple=!!arParams.OFFER_SIMPLE),this.productType=parseInt(arParams.PRODUCT_TYPE,10),this.showQuantity=arParams.SHOW_QUANTITY,this.secondPict=!!arParams.SECOND_PICT,this.showOldPrice=!!arParams.SHOW_OLD_PRICE,this.showPercent=!!arParams.SHOW_DISCOUNT_PERCENT,this.showSkuProps=!!arParams.SHOW_SKU_PROPS,this.showOfferGroup=!!arParams.OFFER_GROUP,this.bigData=!!arParams.BIG_DATA,arParams.ADD_TO_BASKET_ACTION&&(this.basketAction=arParams.ADD_TO_BASKET_ACTION),arParams.REQUEST_URI&&(this.REQUEST_URI=arParams.REQUEST_URI),arParams.SCRIPT_NAME&&(this.SCRIPT_NAME=arParams.SCRIPT_NAME),arParams.ARTICUL&&(this.articul=arParams.ARTICUL),this.showClosePopup=!!arParams.SHOW_CLOSE_POPUP,this.useCompare=!!arParams.DISPLAY_COMPARE,this.useFavorite=!!arParams.DISPLAY_FAVORITE,this.hasServices=!!arParams.HAS_SERVICES,this.serviceIblockID=parseInt(arParams.SERVICE_IBLOCK_ID,10),this.visual=arParams.VISUAL,this.product.IBLOCK_ID=arParams.PRODUCT.IBLOCK_ID,arParams.PRODUCT.IBLOCK_ID_SKU&&(this.product.IBLOCK_ID_SKU=arParams.PRODUCT.IBLOCK_ID_SKU),this.productType){case 0:case 1:case 2:case 4:arParams.PRODUCT&&"object"==typeof arParams.PRODUCT?(this.showQuantity&&(this.product.checkQuantity=arParams.PRODUCT.CHECK_QUANTITY,this.product.isDblQuantity=arParams.PRODUCT.QUANTITY_FLOAT,this.product.checkQuantity&&(this.product.maxQuantity=this.product.isDblQuantity?parseFloat(arParams.PRODUCT.MAX_QUANTITY):parseInt(arParams.PRODUCT.MAX_QUANTITY,10)),this.product.stepQuantity=this.product.isDblQuantity?parseFloat(arParams.PRODUCT.STEP_QUANTITY):parseInt(arParams.PRODUCT.STEP_QUANTITY,10),this.checkQuantity=this.product.checkQuantity,this.isDblQuantity=this.product.isDblQuantity,this.maxQuantity=this.product.maxQuantity,this.stepQuantity=this.product.stepQuantity,this.isDblQuantity&&(this.stepQuantity=Math.round(this.stepQuantity*this.precisionFactor)/this.precisionFactor),void 0!==arParams.PRODUCT.MIN_QUANTITY?this.minQuantity=this.product.minQuantity=this.product.isDblQuantity?parseFloat(arParams.PRODUCT.MIN_QUANTITY):parseInt(arParams.PRODUCT.MIN_QUANTITY,10):this.minQuantity=this.stepQuantity),this.product.canBuy=arParams.PRODUCT.CAN_BUY,this.product.canSubscription=arParams.PRODUCT.SUBSCRIPTION,arParams.PRODUCT.BASIS_PRICE&&(this.currentBasisPrice=arParams.PRODUCT.BASIS_PRICE),arParams.PRODUCT.PRICE_MATRIX&&(this.priceMatrix=arParams.PRODUCT.PRICE_MATRIX),this.canBuy=this.product.canBuy,this.canSubscription=this.product.canSubscription,this.product.name=arParams.PRODUCT.NAME,this.product.pict=arParams.PRODUCT.PICT,this.product.id=arParams.PRODUCT.ID,arParams.PRODUCT.ADD_URL&&(this.product.addUrl=arParams.PRODUCT.ADD_URL),arParams.PRODUCT.BUY_URL&&(this.product.buyUrl=arParams.PRODUCT.BUY_URL),arParams.BASKET&&"object"==typeof arParams.BASKET&&(this.basketData.useProps=!!arParams.BASKET.ADD_PROPS,this.basketData.emptyProps=!!arParams.BASKET.EMPTY_PROPS)):this.errorCode=-1;break;case 3:arParams.OFFERS&&BX.type.isArray(arParams.OFFERS)&&(arParams.PRODUCT&&"object"==typeof arParams.PRODUCT&&(this.product.name=arParams.PRODUCT.NAME,this.product.id=arParams.PRODUCT.ID),this.offers=arParams.OFFERS,this.offerNum=0,arParams.OFFER_SELECTED&&(this.offerNum=parseInt(arParams.OFFER_SELECTED,10)),isNaN(this.offerNum)&&(this.offerNum=0),arParams.TREE_PROPS&&(this.treeProps=arParams.TREE_PROPS),arParams.DEFAULT_PICTURE&&(this.defaultPict.pict=arParams.DEFAULT_PICTURE.PICTURE,this.defaultPict.secondPict=arParams.DEFAULT_PICTURE.PICTURE_SECOND));break;default:this.errorCode=-1}arParams.BASKET&&"object"==typeof arParams.BASKET&&(arParams.BASKET.QUANTITY&&(this.basketData.quantity=arParams.BASKET.QUANTITY),arParams.BASKET.PROPS&&(this.basketData.props=arParams.BASKET.PROPS),arParams.BASKET.BASKET_URL&&(this.basketData.basketUrl=arParams.BASKET.BASKET_URL),3===this.productType&&arParams.BASKET.SKU_PROPS&&(this.basketData.sku_props=arParams.BASKET.SKU_PROPS),arParams.BASKET.ADD_URL_TEMPLATE&&(this.basketData.add_url=arParams.BASKET.ADD_URL_TEMPLATE),arParams.BASKET.BUY_URL_TEMPLATE&&(this.basketData.buy_url=arParams.BASKET.BUY_URL_TEMPLATE),""===this.basketData.add_url&&""===this.basketData.buy_url&&(this.errorCode=-1024)),this.useCompare&&(arParams.COMPARE&&"object"==typeof arParams.COMPARE?(arParams.COMPARE.COMPARE_PATH&&(this.compareData.comparePath=arParams.COMPARE.COMPARE_PATH),arParams.COMPARE.COMPARE_URL_TEMPLATE_DEL&&(this.compareData.compareUrlDel=arParams.COMPARE.COMPARE_URL_TEMPLATE_DEL),arParams.COMPARE.COMPARE_URL_TEMPLATE?this.compareData.compareUrl=arParams.COMPARE.COMPARE_URL_TEMPLATE:this.useCompare=!1):this.useCompare=!1),this.useFavorite&&(arParams.FAVORITE&&"object"==typeof arParams.FAVORITE?(arParams.FAVORITE.FAVORITE_PATH&&(this.favoriteData.Path=arParams.FAVORITE.FAVORITE_PATH),arParams.FAVORITE.FAVORITE_URL_TEMPLATE_DEL&&(this.favoriteData.UrlDel=arParams.FAVORITE.FAVORITE_URL_TEMPLATE_DEL),arParams.FAVORITE.FAVORITE_URL_TEMPLATE?this.favoriteData.Url=arParams.FAVORITE.FAVORITE_URL_TEMPLATE:this.useFavorite=!1,arParams.VISUAL.FAVORITE_ID&&(this.contFavorite=BX(arParams.VISUAL.FAVORITE_ID))):this.useFavorite=!1),this.lastElement=!!arParams.LAST_ELEMENT&&"Y"===arParams.LAST_ELEMENT}0===this.errorCode&&(void 0===window.frameCacheVars||isFrameDataReceived?BX.ready(BX.delegate(this.Init,this)):BX.addCustomEvent("onFrameDataReceived",BX.delegate(this.Init,this)))},window.JCCatalogItem.prototype.Init=function(){var i=0,strPrefix="",TreeItems=null;if(this.obProduct=BX(this.visual.ID),this.obProduct||(this.errorCode=-1),this.obPictFly=BX(this.visual.PICT_FLY),this.obPict,this.secondPict&&this.visual.SECOND_PICT_ID&&(this.obSecondPict=BX(this.visual.SECOND_PICT_ID)),this.obPrice=BX(this.visual.PRICE_ID),this.obPriceOld=BX(this.visual.PRICE_OLD_ID),this.obPrice||(this.errorCode=-16),this.obPriceOld&&"object"==typeof this.currentBasisPrice&&this.currentBasisPrice.DISCOUNT_VALUE===this.currentBasisPrice.VALUE&&void 0!==this.currentBasisPrice.VALUE&&$(this.obPriceOld).hide(),this.showQuantity&&this.visual.QUANTITY_ID&&(this.obQuantity=BX(this.visual.QUANTITY_ID),this.visual.QUANTITY_UP_ID&&(this.obQuantityUp=BX(this.visual.QUANTITY_UP_ID)),this.visual.QUANTITY_DOWN_ID&&(this.obQuantityDown=BX(this.visual.QUANTITY_DOWN_ID)),this.obQuantity||(this.showQuantity=!1)),3===this.productType&&(this.detail&&(this.obSkuTable=BX(this.visual.SKU_TABLE)),this.offers.length>0)){if(this.visual.TREE_ID)for(this.obTree=BX(this.visual.TREE_ID),this.obTree||(this.errorCode=-256),strPrefix=this.visual.TREE_ITEM_ID,i=0;i<this.treeProps.length;i++)if(this.obTreeRows[i]={LIST:BX(strPrefix+this.treeProps[i].ID+"_list")},!this.obTreeRows[i].LIST){this.errorCode=-512;break}this.visual.QUANTITY_MEASURE&&(this.obMeasure=BX(this.visual.QUANTITY_MEASURE))}if(this.obBasketActions=BX(this.visual.BASKET_ACTIONS_ID),this.obBasketActions&&(this.visual.BUY_ID&&(this.obBuyBtn=BX(this.visual.BUY_ID)),this.visual.BUY_ID_2&&(this.obBuyBtn2=BX(this.visual.BUY_ID_2)),this.visual.REQUEST_ID&&(this.obRequestBtn=BX(this.visual.REQUEST_ID))),this.visual.BUY_ONECLICK&&(this.obBuyOneClickBtn=BX(this.visual.BUY_ONECLICK)),this.visual.COMMON_BUY_ID&&(this.obCommonBuyBtn=BX(this.visual.COMMON_BUY_ID)),this.obAvailInfo=BX(this.visual.AVAILABLE_INFO),this.obAvailInfoMobile=BX(this.visual.AVAILABLE_INFO_MOBILE),this.obAvaiblExp=BX(this.visual.AVAIBILITY_EXPANDED),this.obArticul=BX(this.visual.ARTICUL_ID),this.obAvaiblExp&&this.offers.length>0?$(this.obAvaiblExp).data("obbx",this):this.obAvailInfo&&this.offers.length>0&&($(this.obAvailInfo).find(".store-info").data("obbx",this),$(this.obAvailInfoMobile).find(".store-info").data("obbx",this)),this.showPercent&&(this.visual.DSC_PERC&&(this.obDscPerc=BX(this.visual.DSC_PERC)),this.secondPict&&this.visual.SECOND_DSC_PERC&&(this.obSecondDscPerc=BX(this.visual.SECOND_DSC_PERC))),this.showSkuProps&&this.visual.DISPLAY_PROP_DIV&&(this.obSkuProps=BX(this.visual.DISPLAY_PROP_DIV)),0===this.errorCode){var _=this;if(this.showQuantity){var timerQuantity,timerTimeout,$obQuantityButtons=$();this.obQuantityUp&&($obQuantityButtons=$obQuantityButtons.add(this.obQuantityUp)),this.obQuantityDown&&($obQuantityButtons=$obQuantityButtons.add(this.obQuantityDown)),$obQuantityButtons.on({mousedown:function(){var $_=$(this),$quanInput=$(_.obQuantity);if(!($quanInput.hasClass("disabled")||$quanInput.is(":disabled")||$_.hasClass("disabled"))){var changeFunc=$_.hasClass("decrease")?BX.delegate(_.QuantityDown,_):BX.delegate(_.QuantityUp,_);changeFunc(),timerTimeout=setTimeout(function(){timerQuantity=setInterval(changeFunc,100)},300)}},"mouseup mouseleave":function(){clearTimeout(timerTimeout),clearInterval(timerQuantity)}}),this.obQuantity&&BX.bind(this.obQuantity,"change",BX.delegate(this.QuantityChange,this))}switch(this.productType){case 1:break;case 3:if(this.offers.length>0){for(var key in this.skuVisualParams){var TreeItems;if((TreeItems=BX.findChildren(this.obTree,{tagName:this.skuVisualParams[key].TAG_BIND},!0))&&0<TreeItems.length)for(i=0;i<TreeItems.length;i++)$(TreeItems[i]).on(this.skuVisualParams[key].EVENT,BX.delegate(this.SelectOfferProp,this))}this.SetCurrent()}else if(this.skuSimple){var SkuBuyBtns=BX.findChildren(this.obSkuTable,{tagName:"button",className:"buy"},!0);if(SkuBuyBtns&&0<SkuBuyBtns.length){if("ADD"===this.basketAction)var buyFunction=this.Add2Basket;else var buyFunction=this.BuyBasket;for(i=0;i<SkuBuyBtns.length;i++)$(SkuBuyBtns[i]).not(".on-request").on("click",BX.delegate(buyFunction,this))}if(this.useFavorite){var SkuFavoriteBtns=BX.findChildren(this.obSkuTable,{tagName:"button",className:"favorite"},!0);if(SkuFavoriteBtns&&0<SkuFavoriteBtns.length)for(i=0;i<SkuFavoriteBtns.length;i++)$(SkuFavoriteBtns[i]).on("click",BX.delegate(this.Favorite,this))}var SkuQuanDownBtns=BX.findChildren(this.obSkuTable,{tagName:"button",className:"decrease"},!0),SkuQuanUpBtns=BX.findChildren(this.obSkuTable,{tagName:"button",className:"increase"},!0),SkuQuanInputs=BX.findChildren(this.obSkuTable,{tagName:"input",className:"quantity-input"},!0);if(($obQuantityButtons=$(SkuQuanDownBtns).add(SkuQuanUpBtns)).on({mousedown:function(){var $_=$(this),$quanInput=$_.parent().find(".quantity-input");if(!($quanInput.hasClass("disabled")||$quanInput.is(":disabled")||$_.hasClass("disabled"))){var changeFunc=$_.hasClass("decrease")?BX.delegate(_.QuantityDownSimple,_):BX.delegate(_.QuantityUpSimple,_);changeFunc.apply(this),timerTimeout=setTimeout(function(){timerQuantity=setInterval(function(){changeFunc.apply($_[0])},100)},300)}},"mouseup mouseleave":function(){clearTimeout(timerTimeout),clearInterval(timerQuantity)}}),SkuQuanInputs&&0<SkuQuanInputs.length)for(i=0;i<SkuQuanInputs.length;i++)BX.bind(SkuQuanInputs[i],"change",BX.delegate(this.QuantityChangeSimple,this))}}if(this.obBuyBtn&&("ADD"===this.basketAction?(BX.unbindAll(this.obBuyBtn),BX.bind(this.obBuyBtn,"click",BX.delegate(this.Add2Basket,this))):BX.bind(this.obBuyBtn,"click",BX.delegate(this.BuyBasket,this))),this.obBuyBtn2&&("ADD"===this.basketAction?BX.bind(this.obBuyBtn2,"click",BX.delegate(this.Add2Basket,this)):BX.bind(this.obBuyBtn2,"click",BX.delegate(this.BuyBasket,this))),this.lastElement,this.useCompare&&(this.obCompare=BX(this.visual.COMPARE_LINK_ID),this.obCompare&&BX.bind(this.obCompare,"click",BX.proxy(this.Compare,this))),this.useFavorite&&(this.obFavorite=BX(this.visual.FAVORITE_ID),this.obFavorite&&BX.bind(this.obFavorite,"click",BX.proxy(this.Favorite,this))),this.bigData){this.obBigDataContainer=BX(this.visual.BIG_DATA_CONTAINER);var detailLinks=BX.findChildren(this.obProduct,{className:"bx_rcm_view_link"},!0),_this=this;if(detailLinks)for(i in detailLinks)BX.bind(detailLinks[i],"click",function(e){_this.RememberRecommendation(BX(this),BX(this).getAttribute("data-product-id"))})}if(this.detail&&3===this.productType&&this.offers.length>0){var _this=this;$(document).on("click",".print-link",function(){PRINT=!0}),$(window).load(function(){setTimeout(function(){$(window).on("popstate",function(e){"undefined"==typeof PRINT?history.go(-_this.countSkuChangeUrl):PRINT=void 0,e.preventDefault()})},0)})}this.bInit=!0,this.currentIsSet=!0}},window.JCCatalogItem.prototype.checkHeight=function(){this.containerHeight=parseInt(this.obProduct.parentNode.offsetHeight,10),isNaN(this.containerHeight)&&(this.containerHeight=0)},window.JCCatalogItem.prototype.setHeight=function(){0<this.containerHeight&&BX.adjust(this.obProduct.parentNode,{style:{height:this.containerHeight+"px"}})},window.JCCatalogItem.prototype.clearHeight=function(){BX.adjust(this.obProduct.parentNode,{style:{height:"auto"}})},window.JCCatalogItem.prototype.blockBtnUp=function(message){message=void 0===message||message,this.obQuantityUp&&$(this.obQuantityUp).addClass("disabled"),message&&RZB2.ajax.showMessage(BX.message("available-limit-msg"),"fail")},window.JCCatalogItem.prototype.blockBtnDown=function(){this.obQuantityDown&&$(this.obQuantityDown).addClass("disabled")},window.JCCatalogItem.prototype.unblockBtnUp=function(){this.obQuantityUp&&$(this.obQuantityUp).removeClass("disabled")},window.JCCatalogItem.prototype.unblockBtnDown=function(){this.obQuantityDown&&$(this.obQuantityDown).removeClass("disabled")},window.JCCatalogItem.prototype.UpdateBonus=function(count){if(window.ITRElementBonus){void 0!==this.bonusTimeout&&clearTimeout(this.bonusTimeout);var _=this;this.bonusTimeout=setTimeout(function(){delete _.bonusTimeout,bonusElemUp.UpdateBonus(count)},1e3)}},window.JCCatalogItem.prototype.QuantityUp=function(){var curValue=0,boolSet=!0,calcPrice;0===this.errorCode&&this.showQuantity&&this.canBuy&&(curValue=this.isDblQuantity?parseFloat(this.obQuantity.value):parseInt(this.obQuantity.value,10),isNaN(curValue)||(curValue+=this.stepQuantity,this.checkQuantity&&(curValue>this.maxQuantity?(boolSet=!1,this.blockBtnUp()):curValue==this.maxQuantity&&this.blockBtnUp()),boolSet&&(this.unblockBtnDown(),this.isDblQuantity&&(curValue=Math.round(curValue*this.precisionFactor)/this.precisionFactor),this.obQuantity.value=curValue,this.CheckQuantityPrice(curValue),this.UpdateCommonBuyBtn(),this.UpdateBonus(curValue))))},window.JCCatalogItem.prototype.QuantityDown=function(){var curValue=0,boolSet=!0,calcPrice;0===this.errorCode&&this.showQuantity&&this.canBuy&&(curValue=this.isDblQuantity?parseFloat(this.obQuantity.value):parseInt(this.obQuantity.value,10),isNaN(curValue)||((curValue-=this.stepQuantity)<this.minQuantity&&curValue<this.stepQuantity&&(boolSet=!1),curValue<=this.minQuantity&&curValue<=this.stepQuantity&&this.blockBtnDown(),boolSet&&(this.unblockBtnUp(),this.isDblQuantity&&(curValue=Math.round(curValue*this.precisionFactor)/this.precisionFactor),this.obQuantity.value=curValue,this.CheckQuantityPrice(curValue),this.UpdateCommonBuyBtn(),this.UpdateBonus(curValue))))},window.JCCatalogItem.prototype.QuantityChange=function(e,message){var curValue=0,calcPrice,intCount,count;0===this.errorCode&&this.showQuantity&&(this.canBuy?(curValue=this.isDblQuantity?parseFloat(this.obQuantity.value):parseInt(this.obQuantity.value,10),isNaN(curValue)?(this.obQuantity.value=this.stepQuantity,curValue=this.stepQuantity,this.blockBtnDown()):(this.checkQuantity&&(curValue>=this.maxQuantity?(curValue=this.maxQuantity,this.blockBtnUp(message)):this.unblockBtnUp()),curValue<=this.stepQuantity&&curValue<=this.minQuantity?(curValue=this.stepQuantity<this.minQuantity?this.stepQuantity:this.minQuantity,this.blockBtnDown()):(count=Math.round(curValue*this.precisionFactor/this.stepQuantity)/this.precisionFactor,intCount=parseInt(count,10),isNaN(intCount)&&(intCount=1,count=1.1),count>intCount&&(curValue=intCount<=1?this.stepQuantity:intCount*this.stepQuantity,curValue=Math.round(curValue*this.precisionFactor)/this.precisionFactor),this.unblockBtnDown()),this.obQuantity.value=curValue)):(this.obQuantity.value=this.stepQuantity,curValue=this.stepQuantity,this.blockBtnDown()),this.CheckQuantityPrice(this.obQuantity.value),this.UpdateCommonBuyBtn(),this.UpdateBonus(this.obQuantity.value))},window.JCCatalogItem.prototype.QuantityUpSimple=function(){var curValue=0,stepQuantity=1,target=$(BX.proxy_context),quantityInput=target.siblings("input");0===this.errorCode&&(curValue=parseInt(quantityInput.val(),10),isNaN(curValue)||(curValue+=1,Number(curValue)>0&&(quantityInput.val(curValue),target.siblings(".disabled").removeClass("disabled"))))},window.JCCatalogItem.prototype.QuantityDownSimple=function(){var curValue=0,stepQuantity=1,target=$(BX.proxy_context),quantityInput=target.siblings("input");0===this.errorCode&&(curValue=parseInt(quantityInput.val(),10),isNaN(curValue)||((curValue-=1)>0&&quantityInput.val(curValue),curValue<=1&&target.addClass("disabled")))},window.JCCatalogItem.prototype.QuantityChangeSimple=function(){var curValue=0,stepQuantity=1,quantityInput=$(BX.proxy_context);0===this.errorCode&&(curValue=parseInt(quantityInput.val(),10),isNaN(curValue)||Number(curValue)<=1?(curValue=1,quantityInput.val(curValue),quantityInput.siblings(".decrease").addClass("disabled")):quantityInput.siblings(".decrease").removeClass("disabled"))},window.JCCatalogItem.prototype.CheckQuantityPrice=function(quantity){var priceMatrix=this.priceMatrix;if(3!=this.productType||this.skuSimple||(priceMatrix=this.offers[this.offerNum].priceMatrix),priceMatrix&&priceMatrix.ROWS.length)for(var row=priceMatrix.ROWS.length-1;row>=0;row--){var arRow=priceMatrix.ROWS[row];if((arRow.QUANTITY_FROM<=quantity||0==arRow.QUANTITY_FROM)&&(arRow.QUANTITY_TO>=quantity||0==arRow.QUANTITY_TO)){for(var key in priceMatrix.COLS){var arPrice=priceMatrix.MATRIX[key][row];arPrice.VALUE=arPrice.PRICE,arPrice.HTML_VALUE=arPrice.HTML_PRICE,arPrice.DISCOUNT_VALUE=arPrice.DISCOUNT_PRICE,arPrice.HTML_DISCOUNT_VALUE=arPrice.HTML_DISCOUNT_PRICE,this.setPrice(arPrice),window.ITRElementBonus&&(bonusElemUp.Update.params.MIN_PRICE=arPrice.BONUS_PRICE);break}break}}},window.JCCatalogItem.prototype.UpdateCommonBuyBtn=function(){if(this.obCommonBuyBtn){var commonQuantity=0;$('#catalog_section table [name="quantity"]').each(function(){Number($(this).val())>0&&(commonQuantity+=Number($(this).val()))}),$(this.obCommonBuyBtn).find(".number").text(Number(commonQuantity)),Number(commonQuantity)>0?$(this.obCommonBuyBtn).removeClass("disabled"):$(this.obCommonBuyBtn).addClass("disabled")}},window.JCCatalogItem.prototype.QuantitySet=function(index){if(0===this.errorCode){this.canBuy=this.offers[index].CAN_BUY,this.forOrder=this.offers[index].FOR_ORDER,this.onRequest=this.offers[index].ON_REQUEST,$(this.obProduct).find(".buy-block-main .price-wrap, .prices").toggleClass("hide",this.onRequest).end().find(".buy-block-footer").toggleClass("hide",!this.canBuy);var $btnSubscribe=$(this.obProduct).find("a.inform-when-available");if(this.canBuy||this.onRequest){if(this.obBasketActions&&(BX.style(this.obBasketActions,"display",""),$(this.obBasketActions).toggleClass("on-request",this.onRequest)),this.obAvailInfo){$(this.obAvailInfo).removeClass("out-of-stock").toggleClass("available-for-order",this.forOrder||this.onRequest).find(".when-available-for-order").toggleClass("when-available-on-request",this.onRequest);var $text=$(this.obAvailInfo).find(".when-in-stock .info-tag .text");this.offers[index].MAX_QUANTITY>0?$text.attr("data-how-much"," ("+this.offers[index].MAX_QUANTITY+" "+this.offers[index].MEASURE+")"):$text.removeAttr("data-how-much")}if(this.obAvailInfoMobile){$(this.obAvailInfoMobile).removeClass("out-of-stock").toggleClass("available-for-order",this.forOrder||this.onRequest).find(".when-available-for-order").toggleClass("when-available-on-request",this.onRequest);var $text=$(this.obAvailInfoMobile).find(".when-in-stock .info-tag .text");this.offers[index].MAX_QUANTITY>0?$text.attr("data-how-much"," ("+this.offers[index].MAX_QUANTITY+" "+this.offers[index].MEASURE+")"):$text.removeAttr("data-how-much")}this.obBuyOneClickBtn&&$(this.obBuyOneClickBtn).toggleClass("hide",this.onRequest),$btnSubscribe.hide()}else this.obBasketActions&&BX.style(this.obBasketActions,"display","none"),this.obAvailInfo&&$(this.obAvailInfo).addClass("out-of-stock").removeClass("available-for-order"),this.obAvailInfoMobile&&$(this.obAvailInfoMobile).addClass("out-of-stock").removeClass("available-for-order"),this.obBuyOneClickBtn&&$(this.obBuyOneClickBtn).addClass("hide"),$btnSubscribe.show();if(this.showQuantity){$(this.obQuantity).closest(".quantity-counter, .inner-quan-wrap").toggleClass("hide",!this.canBuy||this.onRequest),this.isDblQuantity=this.offers[index].QUANTITY_FLOAT,this.checkQuantity=this.offers[index].CHECK_QUANTITY,this.isDblQuantity?(this.maxQuantity=parseFloat(this.offers[index].MAX_QUANTITY),this.stepQuantity=Math.round(parseFloat(this.offers[index].STEP_QUANTITY)*this.precisionFactor)/this.precisionFactor):(this.maxQuantity=parseInt(this.offers[index].MAX_QUANTITY,10),this.stepQuantity=parseInt(this.offers[index].STEP_QUANTITY,10)),this.obQuantity.value=this.stepQuantity,this.obQuantity.disabled=!this.canBuy,this.QuantityChange(null,!1);var measure=this.offers[index].MEASURE;this.obMeasure&&(this.offers[index].MEASURE?BX.adjust(this.obMeasure,{html:measure}):BX.adjust(this.obMeasure,{html:""})),$(this.obQuantity).parent("[data-tooltip]").each(function(){void 0!==$(this).data("original-title")?$(this).attr("data-original-title",measure).tooltip("fixTitle"):$(this).attr("title",measure)})}this.currentBasisPrice=this.offers[index].BASIS_PRICE}},window.JCCatalogItem.prototype.SelectOfferProp=function(){var i=0,value="",strTreeValue="",arTreeItem=[],RowItems=null,target=BX.proxy_context;if(void 0!==target.options&&void 0!==target.options[target.selectedIndex]&&(target=target.options[target.selectedIndex]),target&&target.hasAttribute("data-treevalue")&&(strTreeValue=target.getAttribute("data-treevalue"),propMode=target.getAttribute("data-showmode"),arTreeItem=strTreeValue.split("_"),this.SearchOfferPropIndex(arTreeItem[0],arTreeItem[1])&&(RowItems=BX.findChildren(target.parentNode,{tagName:this.skuVisualParams[propMode].TAG},!1))&&0<RowItems.length))for(i=0;i<RowItems.length;i++)value=RowItems[i].getAttribute("data-onevalue"),"TEXT"==propMode?value===arTreeItem[1]?RowItems[i].setAttribute("selected","selected"):RowItems[i].removeAttribute("selected"):value===arTreeItem[1]?$(RowItems[i]).addClass("active"):$(RowItems[i]).removeClass("active")},window.JCCatalogItem.prototype.SearchOfferPropIndex=function(strPropID,strPropValue){var strName="",arShowValues=!1,i,j,arCanBuyValues=[],index=-1,arFilter={},tmpFilter=[];for(i=0;i<this.treeProps.length;i++)if(this.treeProps[i].ID===strPropID){index=i;break}if(-1<index){for(i=0;i<index;i++)arFilter[strName="PROP_"+this.treeProps[i].ID]=this.selectedValues[strName];if(strName="PROP_"+this.treeProps[index].ID,!(arShowValues=this.GetRowValues(arFilter,strName)))return!1;if(!BX.util.in_array(strPropValue,arShowValues))return!1;for(arFilter[strName]=strPropValue,i=index+1;i<this.treeProps.length;i++){if(strName="PROP_"+this.treeProps[i].ID,!(arShowValues=this.GetRowValues(arFilter,strName)))return!1;if(this.showAbsent)for(arCanBuyValues=[],tmpFilter=[],tmpFilter=BX.clone(arFilter,!0),j=0;j<arShowValues.length;j++)tmpFilter[strName]=arShowValues[j],this.GetCanBuy(tmpFilter)&&(arCanBuyValues[arCanBuyValues.length]=arShowValues[j]);else arCanBuyValues=arShowValues;this.selectedValues[strName]&&BX.util.in_array(this.selectedValues[strName],arCanBuyValues)?arFilter[strName]=this.selectedValues[strName]:arCanBuyValues.length>0?arFilter[strName]=arCanBuyValues[0]:arFilter[strName]=arShowValues[0],this.UpdateRow(i,arFilter[strName],arShowValues,arCanBuyValues)}this.selectedValues=arFilter,this.ChangeInfo()}return!0},window.JCCatalogItem.prototype.UpdateRow=function(intNumber,activeID,showID,canBuyID){var i=0,value="",countShow=0,propMode=!1,isAvailable=!1,isCurrent=!1,isShown=!1;if(currentShowStart=0,RowItems=null,-1<intNumber&&intNumber<this.obTreeRows.length&&(propMode=this.treeProps[intNumber].SHOW_MODE,RowItems=BX.findChildren(this.obTreeRows[intNumber].LIST,{tagName:this.skuVisualParams[propMode].TAG},!1),RowItems&&0<RowItems.length)){pictMode="PICT"===propMode||"BOX"===propMode,countShow=showID.length;var $list=$(this.obTreeRows[intNumber].LIST),isIkSelect=$list.parent().hasClass("ik_select")&&"object"==typeof $list.data("plugin_ikSelect");for(i=0;i<RowItems.length;i++)value=RowItems[i].getAttribute("data-onevalue"),isAvailable=BX.util.in_array(value,canBuyID),isCurrent=value===activeID,isShown=BX.util.in_array(value,showID),pictMode?$(RowItems[i]).toggleClass("not_available",!isAvailable).toggleClass(this.skuVisualParams.PICT.ACTIVE_CLASS,isCurrent).toggleClass("hide",!isShown):isIkSelect?($list.ikSelect("toggleOptions",i,!0,isShown),$list.data("plugin_ikSelect").$list.find("li.ik_select_option").eq(i).toggleClass("not_available",!isAvailable),isCurrent&&$list.ikSelect("select",i,!0)):($(RowItems[i]).prop("disabled",!isShown).prop("selected",!1).data("available",isAvailable),isCurrent&&$(RowItems[i]).prop("selected",!0));this.quickView||(b2.init.selects&&b2.init.selects($(RowItems).closest("form")),"function"==typeof b2.init.scrollbarsTargeted&&b2.init.scrollbarsTargeted($(RowItems).closest("form").find(".chosen-drop"))),this.showCount[intNumber]=countShow,this.showStart[intNumber]=currentShowStart}},window.JCCatalogItem.prototype.GetRowValues=function(arFilter,index){var i=0,j,arValues=[],boolSearch=!1,boolOneSearch=!0;if(0===arFilter.length){for(i=0;i<this.offers.length;i++)BX.util.in_array(this.offers[i].TREE[index],arValues)||(arValues[arValues.length]=this.offers[i].TREE[index]);boolSearch=!0}else for(i=0;i<this.offers.length;i++){for(j in boolOneSearch=!0,arFilter)if(arFilter[j]!==this.offers[i].TREE[j]){boolOneSearch=!1;break}boolOneSearch&&(BX.util.in_array(this.offers[i].TREE[index],arValues)||(arValues[arValues.length]=this.offers[i].TREE[index]),boolSearch=!0)}return!!boolSearch&&arValues},window.JCCatalogItem.prototype.GetCanBuy=function(arFilter){var i=0,j,boolSearch=!1,boolOneSearch=!0;for(i=0;i<this.offers.length;i++){for(j in boolOneSearch=!0,arFilter)if(arFilter[j]!==this.offers[i].TREE[j]){boolOneSearch=!1;break}if(boolOneSearch&&this.offers[i].CAN_BUY){boolSearch=!0;break}}return boolSearch},window.JCCatalogItem.prototype.SetCurrent=function(){var i=0,j=0,arCanBuyValues=[],strName="",arShowValues=!1,arFilter={},tmpFilter=[],current=this.offers[this.offerNum].TREE;for(i=0;i<this.treeProps.length&&(strName="PROP_"+this.treeProps[i].ID,arShowValues=this.GetRowValues(arFilter,strName));i++){if(BX.util.in_array(current[strName],arShowValues)?arFilter[strName]=current[strName]:(arFilter[strName]=arShowValues[0],this.offerNum=0),this.showAbsent)for(arCanBuyValues=[],tmpFilter=[],tmpFilter=BX.clone(arFilter,!0),j=0;j<arShowValues.length;j++)tmpFilter[strName]=arShowValues[j],this.GetCanBuy(tmpFilter)&&(arCanBuyValues[arCanBuyValues.length]=arShowValues[j]);else arCanBuyValues=arShowValues;this.UpdateRow(i,arFilter[strName],arShowValues,arCanBuyValues)}this.selectedValues=arFilter,this.ChangeInfo()},window.JCCatalogItem.prototype.ChangeInfo=function(){var i=0,j,index=-1,boolOneSearch=!0;for(i=0;i<this.offers.length;i++){for(j in boolOneSearch=!0,this.selectedValues)if(this.selectedValues[j]!==this.offers[i].TREE[j]){boolOneSearch=!1;break}if(boolOneSearch){index=i;break}}if(-1<index){if(this.detail&&!this.quickView){for(i=0;i<this.offers.length;i++)this.showOfferGroup&&this.offers[i].OFFER_GROUP&&i!==index&&BX.adjust(BX(this.visual.OFFER_GROUP+this.offers[i].ID),{style:{display:"none"}});this.showOfferGroup&&this.offers[index].OFFER_GROUP&&BX.adjust(BX(this.visual.OFFER_GROUP+this.offers[index].ID),{style:{display:""}})}if(this.obPict=BX(this.visual.PICT_ID),this.obPictModal=BX(this.visual.PICT_MODAL),this.obPict){var obData={attrs:{}};this.offers[index].PICTURE_PRINT?(obData.attrs.src=this.offers[index].PICTURE_PRINT.SRC,this.detail&&(obData.attrs["data-big-src"]=this.offers[index].PICTURE_PRINT.SRC_BIG),this.detail||(obData.attrs["data-original"]=this.offers[index].PICTURE_PRINT.SRC)):(obData.attrs.src=this.defaultPict.pict.SRC,this.detail&&(obData.attrs["data-big-src"]=this.defaultPict.pict.SRC_BIG)),BX.adjust(this.obPict,obData),this.obPictModal&&(obData.attrs.src=obData.attrs["data-big-src"],BX.adjust(this.obPictModal,obData))}this.detail&&"zoom"===b2.s.photoViewType&&void 0!==b2.el.$productPhotoImg&&b2.el.$productPhotoImg.each(function(){var $wrap=$(this);$wrap.magnify({src:$wrap.attr("data-zoom")})});var catchbuyTimer=$("#"+this.visual.ID+"_countdown_"+this.offers[index].ID).show();$(this.obProduct).find(".countdown").not(catchbuyTimer).hide(),$(this.obProduct).find(".sticker.hurry-buy").toggle(catchbuyTimer.length>0),$("#photo-block").toggleClass("has-timer",catchbuyTimer.length>0),this.detail?($("#photo-block .gallery-carousel.carousel.slide").hide(),$("#modal_big-img .gallery-carousel.carousel.slide").hide()):$(this.obProduct).find(".photo-thumbs").hide();var $slider=$("#"+this.visual.SLIDER_CONT_OF_ID+this.offers[index].ID),$galleryInner=$("#"+this.visual.SLIDER_CONT_OF_INNER_ID+this.offers[index].ID),$modalThumbs=$("#"+this.visual.SLIDER_MODAL_CONT_OF_ID+this.offers[index].ID),$modalInner=$("#"+this.visual.SLIDER_CONT_OF_MODAL_INNER_ID+this.offers[index].ID);if(this.contFavorite&&($(this.contFavorite).attr("data-favorite-id",this.offers[index].ID),RZB2.ajax.Favorite.RefreshButtons()),this.detail&&($galleryInner.length&&($("#photo-block .thumbnails-wrap").removeClass("active"),$galleryInner.find(".thumbnails-wrap").addClass("active"),$galleryInner.show(),void 0!==b2.init.galleryCarouselUpdate&&b2.init.galleryCarouselUpdate($galleryInner.parent())),$modalInner.length&&($("#modal_big-img").find(".thumbnails-frame").removeClass("active"),$modalInner.find(".thumbnails-frame").addClass("active"),$modalInner.show(),void 0!==b2.init.galleryCarouselUpdate&&b2.init.galleryCarouselUpdate($modalInner.parent())),$modalThumbs.length&&$modalThumbs.show()),$galleryInner.find(".thumb").length?($galleryInner.data("init")||$galleryInner.data("init",!0).find(".img-wrap img").each(function(){this.src=$(this).data("src"),$(this).removeData("src")}),this.detail?($modalInner.length&&($modalInner.data("init")||$modalInner.data("init",!0).find(".big-img img").each(function(){this.src=$(this).data("src"),$(this).removeData("src")})),$(".product-photos, .modal_big-img").removeClass("no-thumbs")):initPhotoThumbs($(this.obProduct))):this.detail?$(".product-photos, .modal_big-img").addClass("no-thumbs"):($("#"+this.visual.SLIDER_CONT_OF_ID+this.offers[index].ID).show(),initPhotoThumbs($(this.obProduct))),this.detail&&this.obPictFly){var obData={attrs:{}};this.offers[index].PICTURE_PRINT?obData.attrs.src=this.offers[index].PICTURE_PRINT.SRC_FLY:obData.attrs.src=this.defaultPict.pict.SRC_FLY,BX.adjust(this.obPictFly,obData)}if(this.secondPict&&this.obSecondPict&&(this.offers[index].PREVIEW_PICTURE_SECOND?BX.adjust(this.obSecondPict,{style:{backgroundImage:"url("+this.offers[index].PREVIEW_PICTURE_SECOND.SRC+")"}}):this.offers[index].PREVIEW_PICTURE.SRC?BX.adjust(this.obSecondPict,{style:{backgroundImage:"url("+this.offers[index].PREVIEW_PICTURE.SRC+")"}}):this.defaultPict.secondPict?BX.adjust(this.obSecondPict,{style:{backgroundImage:"url("+this.defaultPict.secondPict.SRC+")"}}):BX.adjust(this.obSecondPict,{style:{backgroundImage:"url("+this.defaultPict.pict.SRC+")"}})),this.showSkuProps&&this.obSkuProps){var $detailedTech=$(".detailed-tech");0===this.offers[index].DISPLAY_PROPERTIES.length?(BX.adjust(this.obSkuProps,{html:" "}),$(".tech-info-block").length<2&&$detailedTech.find("dt").length<1&&$detailedTech.hide()):(BX.adjust(this.obSkuProps,{html:this.offers[index].DISPLAY_PROPERTIES}),$detailedTech.show())}if(this.visual.DETAIL_LINK_CLASS&&void 0!==this.offers[index].URL&&this.offers[index].URL.length&&$(this.obProduct).find("."+this.visual.DETAIL_LINK_CLASS).attr("href",this.offers[index].URL),this.obBuyOneClickBtn&&$(this.obBuyOneClickBtn).data("id",this.offers[index].ID),this.obBuyBtn&&$(this.obBuyBtn).attr("data-offer-id",this.offers[index].ID),this.obRequestBtn&&$(this.obRequestBtn).attr("data-offer-id",this.offers[index].ID).attr("data-measure-name",this.offers[index].MEASURE),this.obArticul){var articul=this.offers[index].ARTICUL||this.articul;articul?$(this.obArticul).removeClass("hidden").find("strong").text(articul):$(this.obArticul).addClass("hidden")}this.detail&&!this.quickView&&this.offers[index].URL&&(RZB2.ajax.setLocation(this.offers[index].URL),this.countSkuChangeUrl++),this.setPrice(this.offers[index].PRICE);var $btnPriceDrop=$(this.obProduct).find("a.inform-when-price-drops");$btnPriceDrop.length>0&&($btnPriceDrop.data("price",this.offers[index].BUY_PRICE.DISCOUNT_VALUE),$btnPriceDrop.data("product",this.offers[index].ID),$btnPriceDrop.data("price_type",this.offers[index].BUY_PRICE.PRICE_ID),$btnPriceDrop.data("currency",this.offers[index].BUY_PRICE.CURRENCY));var $btnPriceCry=$(this.obProduct).find("a.cry-for-price");$btnPriceCry.length>0&&($btnPriceCry.data("price",this.offers[index].BUY_PRICE.DISCOUNT_VALUE),$btnPriceCry.data("product",this.offers[index].ID),$btnPriceCry.data("price_type",this.offers[index].BUY_PRICE.PRICE_ID),$btnPriceCry.data("currency",this.offers[index].BUY_PRICE.CURRENCY));var $btnSubscribe=$(this.obProduct).find("a.inform-when-available").add($(this.obAvailInfo).find(".when-out-of-stock .info-tag"));$btnSubscribe.length>0&&$btnSubscribe.data("product",this.offers[index].ID);var $additional=$(this.obProduct).find(".additional-price-container");if("ADDITIONAL_PRICES"in this.offers[index]&&this.offers[index].ADDITIONAL_PRICES.length>0?($additional.removeClass("hidden"),$additional.html(this.offers[index].ADDITIONAL_PRICES).find(".b-rub").html(BX.message("b-rub")),"function"==typeof b2.init.scrollbarsTargeted&&b2.init.scrollbarsTargeted($additional[0])):$additional.addClass("hidden"),this.showPercent){var $discount=$(this.obPrice).next("div.price-w-discount");$discount.length?parseFloat(this.offers[index].PRICE.DISCOUNT_DIFF)>0?$discount.find(".text").text(this.offers[index].PRICE.DISCOUNT_DIFF_PERCENT+"%"):$discount.remove():parseFloat(this.offers[index].PRICE.DISCOUNT_DIFF)>0&&$(this.obPrice).after('<div class="sticker price-w-discount"><span class="text">'+this.offers[index].PRICE.DISCOUNT_DIFF_PERCENT+"%</span></div>")}window.ITRElementBonus&&(bonusElemUp.Update.params.IBLOCK_ID=this.product.IBLOCK_ID_SKU,bonusElemUp.Update.params.MIN_PRICE=this.offers[index].BONUS_PRICE,bonusElemUp.Update.params.PRODUCT_ID=this.offers[index].ID),this.offerNum=index,this.QuantitySet(this.offerNum),RZB2.ajax.BasketSmall.ButtonsViewStatus($(this.obBuyBtn),void 0!==RZB2.ajax.BasketSmall.ElementsList[this.offers[index].ID],!0),this.detail&&(this.incViewedCounter(),this.obAvaiblExp),this.updateStores(),this.detail&&this.obAvaiblExp&&(this.forOrder||this.onRequest?($(this.obAvaiblExp).hide(),$(this.obAvaiblExp).closest(".combo-target").hide(),$('.combo-link[href="#'+this.obAvaiblExp.id+'"]').hide()):this.canBuy&&($(this.obAvaiblExp).show(),$(this.obAvaiblExp).closest(".combo-target").show(),!$(this.obAvaiblExp).closest(".combo-target").length||$(this.obAvaiblExp).closest(".combo-target").hasClass("shown")||$(this.obAvaiblExp).closest(".combo-target").hasClass("tabs")?$(this.obAvaiblExp).closest(".combo-target").hasClass("tabs")&&!$(this.obAvaiblExp).closest("#product-info-sections").find(".combo-link.tab-store").hasClass("active")&&$(this.obAvaiblExp).hide():$(this.obAvaiblExp).hide(),$('.combo-link[href="#'+this.obAvaiblExp.id+'"]').show()))}},window.JCCatalogItem.prototype.updateStores=function(){BX.onCustomEvent("onCatalogStoreProductChange",[this.offers[this.offerNum].ID])},window.JCCatalogItem.prototype.setPrice=function(price){var strPrice,obData;if(this.obPrice){var $price=$(this.obPrice),$quanPrice=$price.find(".quan-price").remove();$price.html(price.HTML_DISCOUNT_VALUE).append($quanPrice).find(".b-rub").html(BX.message("b-rub")),this.showOldPrice&&this.obPriceOld&&(price.DISCOUNT_VALUE!==price.VALUE?$(this.obPriceOld).show().html(price.HTML_VALUE).find(".b-rub").html(BX.message("b-rub")):$(this.obPriceOld).hide()),this.showPercent&&(obData=price.DISCOUNT_VALUE!==price.VALUE?{style:{display:""},html:price.DISCOUNT_DIFF_PERCENT}:{style:{display:"none"},html:""},this.obDscPerc&&BX.adjust(this.obDscPerc,obData),this.obSecondDscPerc&&BX.adjust(this.obSecondDscPerc,obData))}},window.JCCatalogItem.prototype.Compare=function(e){var compareParams,compareLink,spinnerParams;if(!this.detail&&$(this.obCompare).hasClass("toggled")&&Object.keys(RZB2.ajax.Compare.ElementsList).length>1){if(!$(this.obCompare).data("delete"))return $(this.obProduct).find(".compare-tooltip").removeClass("hide"),$(this.obCompare).addClass("clicked"),!1;$(this.obCompare).removeData("delete")}if($(this.obCompare).hasClass("toggled")?(compareLink=this.compareData.compareUrlDel,this.compareData.Added=!1):(compareLink=this.compareData.compareUrl,this.compareData.Added=!0,spinnerParams={color:RZB2.themeColor}),compareLink){var itemId="";switch(this.productType){case 1:case 2:case 3:case 4:itemId=this.product.id}this.compareData.Added?(RZB2.ajax.Compare.ElementsList[itemId]=itemId,!this.detail&&Object.keys(RZB2.ajax.Compare.ElementsList).length>1&&($(this.obProduct).find(".compare-tooltip").removeClass("hide"),$(this.obCompare).addClass("clicked"))):void 0!==RZB2.ajax.Compare.ElementsList[itemId]&&delete RZB2.ajax.Compare.ElementsList[itemId],compareLink=compareLink.replace("#ID#",itemId.toString()),compareParams={ajax_action:"Y"},BX.ajax.loadJSON(compareLink,compareParams,BX.proxy(this.CompareResult,this))}},window.JCCatalogItem.prototype.CompareResult=function(result){var popupContent,popupButtons,popupTitle;return this.obPopupWin&&this.obPopupWin.close(),"object"==typeof result&&("OK"===result.STATUS?(RZB2.ajax.Compare.Refresh(),RZB2.ajax.Compare.ButtonsViewStatus($(this.obCompare),this.compareData.Added)):(RZB2.ajax.showMessage(result.MESSAGE?result.MESSAGE:BX.message("BITRONIC2_COMPARE_UNKNOWN_ERROR"),"fail"),RZB2.ajax.Compare.ButtonsViewStatus($(this.obCompare),!1)),!1)},window.JCCatalogItem.prototype.CompareRedirect=function(){this.compareData.comparePath?location.href=this.compareData.comparePath:this.obPopupWin.close()},window.JCCatalogItem.prototype.Favorite=function(){var params,link,spinnerParams;if($(this.obFavorite).hasClass("toggled")?(link=this.favoriteData.UrlDel,this.favoriteData.Added=!1):(link=this.favoriteData.Url,this.favoriteData.Added=!0,spinnerParams={color:RZB2.themeColor}),link){var itemId="";switch(this.productType){case 1:case 2:case 4:itemId=this.product.id;break;case 3:var target;if(this.skuSimple)itemId=$(BX.proxy_context).data("offer-id");else itemId=this.offers[this.offerNum].ID}this.favoriteData.Added?RZB2.ajax.Favorite.ElementsList[itemId]=itemId:void 0!==RZB2.ajax.Favorite.ElementsList[itemId]&&delete RZB2.ajax.Favorite.ElementsList[itemId],void 0===this.favoriteSpinner&&(this.favoriteSpinner=RZB2.ajax.spinner($(this.obFavorite)),this.favoriteSpinner.Start(spinnerParams)),link=link.replace("#ID#",itemId.toString()),params={ajax_action:"Y"},BX.ajax.loadJSON(link,params,BX.proxy(this.FavoriteResult,this))}},window.JCCatalogItem.prototype.FavoriteResult=function(result){var popupContent,popupButtons,popupTitle;if("object"==typeof this.favoriteSpinner&&(this.favoriteSpinner.Stop(),this.favoriteSpinner=void 0),"object"!=typeof result){$(this.obFavorite).hasClass("toggled")?(link=this.favoriteData.UrlDel,this.favoriteData.Added=!1):(link=this.favoriteData.Url,this.favoriteData.Added=!0,spinnerParams={color:RZB2.themeColor});var itemId=this.product.id;return void 0!==RZB2.ajax.Favorite.ElementsList[itemId]&&delete RZB2.ajax.Favorite.ElementsList[itemId],alert(BX.message("error-favorite")),!1}if("success"===result.result){RZB2.ajax.Favorite.Refresh();var curVal=parseInt($(this.obFavorite).find("i").text());isNaN(curVal)||(curVal+=this.favoriteData.Added?1:-1,$(this.obFavorite).find("i").text(curVal))}else RZB2.ajax.showMessage(result.msg?result.msg:BX.message("BITRONIC2_FAVORITE_UNKNOWN_ERROR"),"fail");return!1},window.JCCatalogItem.prototype.InitBasketUrl=function(){var itemId=0;switch(this.basketUrl="ADD"===this.basketMode?this.basketData.add_url:this.basketData.buy_url,this.productType){case 1:case 2:case 4:itemId=this.product.id.toString();break;case 3:this.skuSimple?this.selectedOfferId&&(itemId=this.selectedOfferId):itemId=this.offers[this.offerNum].ID}if(this.basketItemAdded=itemId,this.basketUrl=this.basketUrl.replace("#ID#",itemId),this.basketParams={ajax_basket:"Y"},this.REQUEST_URI&&(this.basketParams.REQUEST_URI=this.REQUEST_URI),this.SCRIPT_NAME&&(this.basketParams.SCRIPT_NAME=this.SCRIPT_NAME),RZB2.ajax.params.CUSTOM_CACHE_KEY&&(this.basketParams.CUSTOM_CACHE_KEY=RZB2.ajax.params.CUSTOM_CACHE_KEY),this.basketParams.IBLOCK_ID=this.product.IBLOCK_ID,this.skuSimple){var target,quantity=$(BX.proxy_context).closest("tr").find(".quantity-counter input").val();quantity&&(this.basketParams[this.basketData.quantity]=quantity)}else this.showQuantity&&this.obQuantity&&(this.basketParams[this.basketData.quantity]=this.obQuantity.value);this.basketData.sku_props&&(this.basketParams[this.basketData.sku_props_var]=this.basketData.sku_props)},window.JCCatalogItem.prototype.FillBasketProps=function(){if(this.visual.BASKET_PROP_DIV){var i=0,propCollection=null,foundValues=!1,obBasketProps=null;if(this.basketData.useProps&&!this.basketData.emptyProps&&(obBasketProps=this.obPopupWin&&this.obPopupWin.contentContainer?this.obPopupWin.contentContainer:BX(this.visual.BASKET_PROP_DIV)),obBasketProps){if((propCollection=obBasketProps.getElementsByTagName("select"))&&propCollection.length)for(i=0;i<propCollection.length;i++)if(!propCollection[i].disabled)switch(propCollection[i].type.toLowerCase()){case"select-one":this.basketParams[propCollection[i].name]=propCollection[i].value,this.inputProps=!0,foundValues=!0}if((propCollection=obBasketProps.getElementsByTagName("input"))&&propCollection.length)for(i=0;i<propCollection.length;i++)if(!propCollection[i].disabled)switch(propCollection[i].type.toLowerCase()){case"hidden":this.basketParams[propCollection[i].name]=propCollection[i].value,foundValues=!0;break;case"radio":propCollection[i].checked&&(this.basketParams[propCollection[i].name]=propCollection[i].value,this.inputProps=!0,foundValues=!0)}}foundValues||(this.basketParams[this.basketData.props]=[],this.basketParams[this.basketData.props][0]=0)}},window.JCCatalogItem.prototype.Add2Basket=function(){this.basketMode="ADD",this.Basket()},window.JCCatalogItem.prototype.BuyBasket=function(){this.basketMode="BUY",this.Basket()},window.JCCatalogItem.prototype.SendToBasket=function(){if(this.canBuy){if(this.InitBasketUrl(),this.FillBasketProps(),!this.inputProps){if(void 0!==RZB2.ajax.BasketSmall.ElementsList[this.basketItemAdded])return void this.BasketRedirect();RZB2.ajax.BasketSmall.ElementsList[this.basketItemAdded]=this.basketItemAdded,RZB2.ajax.BasketSmall.ButtonsViewStatus($(this.obBuyBtn),!0,!0)}if(this.bigData&&this.product&&this.product.id&&this.RememberRecommendation(this.obProduct,this.product.id),BX.onCustomEvent("rbsBeforeAddToBasket",[this.basketUrl,this.basketParams]),BX.ajax.loadJSON(this.basketUrl,this.basketParams,BX.delegate(this.BasketResult,this)),this.hasServices){var productName=this.product.name;this.offers&&this.offers.length>0&&(productName=this.offers[this.offerNum].NAME),this.selectedOfferId>0&&this.offerName&&(productName=this.offerName),RZB2.ajax.Services.AddToBasket(productName,this.serviceIblockID,this.basketParams.quantity)}}},window.JCCatalogItem.prototype.Basket=function(){var contentBasketProps="";if(this.canBuy)switch(this.productType){case 1:case 2:case 4:this.SendToBasket();break;case 3:if(this.skuSimple){var target=$(BX.proxy_context);target.data("offer-id")>0?(this.selectedOfferId=parseInt(target.data("offer-id"),10),this.offerName=target.data("offer-name"),void 0===this.skuSpinner&&void 0===RZB2.ajax.BasketSmall.ElementsList[this.selectedOfferId]&&(this.skuSpinner=RZB2.ajax.spinner(target),this.skuSpinner.Start({radius:3,width:2})),this.SendToBasket()):(this.selectedOfferId=!1,this.ScrollToSkuTable())}else this.SendToBasket()}},window.JCCatalogItem.prototype.BasketResult=function(arResult){var strContent="",strPict="",successful,buttons=[];if(this.obPopupWin&&this.obPopupWin.close(),"object"!=typeof arResult)return!1;if((successful="OK"===arResult.STATUS)&&"BUY"===this.basketAction)this.BasketRedirect();else if(successful){var itemParams={id:this.basketItemAdded,iblockId:this.product.IBLOCK_ID};this.product.IBLOCK_ID_SKU&&(itemParams.iblockIdSku=this.product.IBLOCK_ID_SKU),this.product.id&&(itemParams.parentId=this.product.id),RZB2.ajax.BasketSmall.Refresh(!1,itemParams)}else RZB2.ajax.showMessage(arResult.MESSAGE?arResult.MESSAGE:BX.message("BITRONIC2_BASKET_UNKNOWN_ERROR"),"fail")},window.JCCatalogItem.prototype.BasketRedirect=function(){location.href=this.basketData.basketUrl?this.basketData.basketUrl:BX.message("BASKET_URL")},window.JCCatalogItem.prototype.ScrollToSkuTable=function(){if(this.obSkuTable)if(this.quickView){var modalOffset=$(".modal_quick-view").offset().top,tableOffset=$(this.obSkuTable).offset().top;$("#modal_quick-view").animate({scrollTop:30-modalOffset+tableOffset},800)}else $("html,body").animate({scrollTop:$(this.obSkuTable).offset().top-60},800)},window.JCCatalogItem.prototype.InitPopupWindow=function(){this.obPopupWin||(this.obPopupWin=BX.PopupWindowManager.create("CatalogSectionBasket_"+this.visual.ID,null,{autoHide:!1,offsetLeft:0,offsetTop:0,overlay:!0,closeByEsc:!0,titleBar:!0,closeIcon:{top:"10px",right:"10px"}}))},window.JCCatalogItem.prototype.getUrlVars=function(){for(var $_GET={},__GET=window.location.search.substring(1).split("&"),i=0;i<__GET.length;i++){var getVar=__GET[i].split("=");$_GET[getVar[0]]=void 0===getVar[1]?"":getVar[1]}return $_GET},window.JCCatalogItem.prototype.incViewedCounter=function(){if(this.currentIsSet&&!this.updateViewedCount){switch(this.productType){case 1:case 2:this.viewedCounter.params.PRODUCT_ID=this.product.id,this.viewedCounter.params.PARENT_ID=this.product.id;break;case 3:this.viewedCounter.params.PARENT_ID=this.product.id,this.viewedCounter.params.PRODUCT_ID=this.skuSimple?this.product.id:this.offers[this.offerNum].ID;break;default:return}this.viewedCounter.params.SITE_ID=BX.message("SITE_ID"),this.updateViewedCount=!0,BX.ajax.post(this.viewedCounter.path,this.viewedCounter.params,BX.delegate(function(){this.updateViewedCount=!1},this))}},window.JCCatalogItem.prototype.allowViewedCount=function(update){update=!!update,this.currentIsSet=!0,update&&this.incViewedCounter()},window.JCCatalogItem.prototype.RememberRecommendation=function(obj,productId){var rcmId=$('.btn-action[data-product-id="'+productId+'"] [name="bigdata_recommendation_id"]').val(),plCookieName="_RCM_PRODUCT_LOG",plCookie=RZB2.utils.getCookie(plCookieName,BX.cookie_prefix),itemFound=!1,cItems=[],cItem;plCookie&&(cItems=plCookie.split("."));for(var i=cItems.length;i--;)(cItem=cItems[i].split("-"))[0]==productId?((cItem=cItems[i].split("-"))[1]=rcmId,cItem[2]=BX.current_server_time,cItems[i]=cItem.join("-"),itemFound=!0):BX.current_server_time-cItem[2]>2592e3&&cItems.splice(i,1);itemFound||cItems.push([productId,rcmId,BX.current_server_time].join("-"));var plNewCookie=cItems.join(".");RZB2.utils.setCookie(plCookieName,plNewCookie,BX.cookie_prefix)}}}(window);